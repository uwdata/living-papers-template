import e from"https://api.observablehq.com/@jheer/scrubber.js?v=3";import t from"https://api.observablehq.com/@d3/multi-line-chart.js?v=3";
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const n=window,r=n.ShadowRoot&&(void 0===n.ShadyCSS||n.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,i=Symbol(),s=new WeakMap;const o=e=>new class{constructor(e,t,n){if(this._$cssResult$=!0,n!==i)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(r&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=s.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&s.set(t,e))}return e}toString(){return this.cssText}}("string"==typeof e?e:e+"",void 0,i),a=r?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return o(t)})(e):e
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var l;const c=window,u=c.trustedTypes,d=u?u.emptyScript:"",h=c.reactiveElementPolyfillSupport,f={toAttribute(e,t){switch(t){case Boolean:e=e?d:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},p=(e,t)=>t!==e&&(t==t||e==e),m={attribute:!0,type:String,converter:f,reflect:!1,hasChanged:p};let v=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,n)=>{const r=this._$Ep(n,t);void 0!==r&&(this._$Ev.set(r,n),e.push(r))})),e}static createProperty(e,t=m){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const n="symbol"==typeof e?Symbol():"__"+e,r=this.getPropertyDescriptor(e,n,t);void 0!==r&&Object.defineProperty(this.prototype,e,r)}}static getPropertyDescriptor(e,t,n){return{get(){return this[t]},set(r){const i=this[e];this[t]=r,this.requestUpdate(e,i,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||m}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const n of t)this.createProperty(n,e[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(a(e))}else void 0!==e&&t.push(a(e));return t}static _$Ep(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,n;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(n=e.hostConnected)||void 0===n||n.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{r?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const r=document.createElement("style"),i=n.litNonce;void 0!==i&&r.setAttribute("nonce",i),r.textContent=t.cssText,e.appendChild(r)}))})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EO(e,t,n=m){var r;const i=this.constructor._$Ep(e,n);if(void 0!==i&&!0===n.reflect){const s=(void 0!==(null===(r=n.converter)||void 0===r?void 0:r.toAttribute)?n.converter:f).toAttribute(t,n.type);this._$El=e,null==s?this.removeAttribute(i):this.setAttribute(i,s),this._$El=null}}_$AK(e,t){var n;const r=this.constructor,i=r._$Ev.get(e);if(void 0!==i&&this._$El!==i){const e=r.getPropertyOptions(i),s="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(n=e.converter)||void 0===n?void 0:n.fromAttribute)?e.converter:f;this._$El=i,this[i]=s.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,n){let r=!0;void 0!==e&&(((n=n||this.constructor.getPropertyOptions(e)).hasChanged||p)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===n.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,n))):r=!1),!this.isUpdatePending&&r&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(n)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(n)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}};
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var y;v.finalized=!0,v.elementProperties=new Map,v.elementStyles=[],v.shadowRootOptions={mode:"open"},null==h||h({ReactiveElement:v}),(null!==(l=c.reactiveElementVersions)&&void 0!==l?l:c.reactiveElementVersions=[]).push("1.6.1");const b=window,_=b.trustedTypes,w=_?_.createPolicy("lit-html",{createHTML:e=>e}):void 0,g="$lit$",A=`lit$${(Math.random()+"").slice(9)}$`,E="?"+A,$=`<${E}>`,S=document,k=()=>S.createComment(""),x=e=>null===e||"object"!=typeof e&&"function"!=typeof e,T=Array.isArray,C="[ \t\n\f\r]",N=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,R=/-->/g,j=/>/g,O=RegExp(`>|${C}(?:([^\\s"'>=/]+)(${C}*=${C}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),M=/'/g,I=/"/g,P=/^(?:script|style|textarea|title)$/i,L=(e=>(t,...n)=>({_$litType$:e,strings:t,values:n}))(1),D=Symbol.for("lit-noChange"),q=Symbol.for("lit-nothing"),U=new WeakMap,B=S.createTreeWalker(S,129,null,!1),H=(e,t)=>{const n=e.length-1,r=[];let i,s=2===t?"<svg>":"",o=N;for(let t=0;t<n;t++){const n=e[t];let a,l,c=-1,u=0;for(;u<n.length&&(o.lastIndex=u,l=o.exec(n),null!==l);)u=o.lastIndex,o===N?"!--"===l[1]?o=R:void 0!==l[1]?o=j:void 0!==l[2]?(P.test(l[2])&&(i=RegExp("</"+l[2],"g")),o=O):void 0!==l[3]&&(o=O):o===O?">"===l[0]?(o=null!=i?i:N,c=-1):void 0===l[1]?c=-2:(c=o.lastIndex-l[2].length,a=l[1],o=void 0===l[3]?O:'"'===l[3]?I:M):o===I||o===M?o=O:o===R||o===j?o=N:(o=O,i=void 0);const d=o===O&&e[t+1].startsWith("/>")?" ":"";s+=o===N?n+$:c>=0?(r.push(a),n.slice(0,c)+g+n.slice(c)+A+d):n+A+(-2===c?(r.push(void 0),t):d)}const a=s+(e[n]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==w?w.createHTML(a):a,r]};class F{constructor({strings:e,_$litType$:t},n){let r;this.parts=[];let i=0,s=0;const o=e.length-1,a=this.parts,[l,c]=H(e,t);if(this.el=F.createElement(l,n),B.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(r=B.nextNode())&&a.length<o;){if(1===r.nodeType){if(r.hasAttributes()){const e=[];for(const t of r.getAttributeNames())if(t.endsWith(g)||t.startsWith(A)){const n=c[s++];if(e.push(t),void 0!==n){const e=r.getAttribute(n.toLowerCase()+g).split(A),t=/([.?@])?(.*)/.exec(n);a.push({type:1,index:i,name:t[2],strings:e,ctor:"."===t[1]?J:"?"===t[1]?Z:"@"===t[1]?K:G})}else a.push({type:6,index:i})}for(const t of e)r.removeAttribute(t)}if(P.test(r.tagName)){const e=r.textContent.split(A),t=e.length-1;if(t>0){r.textContent=_?_.emptyScript:"";for(let n=0;n<t;n++)r.append(e[n],k()),B.nextNode(),a.push({type:2,index:++i});r.append(e[t],k())}}}else if(8===r.nodeType)if(r.data===E)a.push({type:2,index:i});else{let e=-1;for(;-1!==(e=r.data.indexOf(A,e+1));)a.push({type:7,index:i}),e+=A.length-1}i++}}static createElement(e,t){const n=S.createElement("template");return n.innerHTML=e,n}}function W(e,t,n=e,r){var i,s,o,a;if(t===D)return t;let l=void 0!==r?null===(i=n._$Co)||void 0===i?void 0:i[r]:n._$Cl;const c=x(t)?void 0:t._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(s=null==l?void 0:l._$AO)||void 0===s||s.call(l,!1),void 0===c?l=void 0:(l=new c(e),l._$AT(e,n,r)),void 0!==r?(null!==(o=(a=n)._$Co)&&void 0!==o?o:a._$Co=[])[r]=l:n._$Cl=l),void 0!==l&&(t=W(e,l._$AS(e,t.values),l,r)),t}class z{constructor(e,t){this.u=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(e){var t;const{el:{content:n},parts:r}=this._$AD,i=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:S).importNode(n,!0);B.currentNode=i;let s=B.nextNode(),o=0,a=0,l=r[0];for(;void 0!==l;){if(o===l.index){let t;2===l.type?t=new V(s,s.nextSibling,this,e):1===l.type?t=new l.ctor(s,l.name,l.strings,this,e):6===l.type&&(t=new X(s,this,e)),this.u.push(t),l=r[++a]}o!==(null==l?void 0:l.index)&&(s=B.nextNode(),o++)}return i}p(e){let t=0;for(const n of this.u)void 0!==n&&(void 0!==n.strings?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class V{constructor(e,t,n,r){var i;this.type=2,this._$AH=q,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=r,this._$Cm=null===(i=null==r?void 0:r.isConnected)||void 0===i||i}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cm}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=W(this,e,t),x(e)?e===q||null==e||""===e?(this._$AH!==q&&this._$AR(),this._$AH=q):e!==this._$AH&&e!==D&&this.g(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>T(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.k(e):this.g(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}g(e){this._$AH!==q&&x(this._$AH)?this._$AA.nextSibling.data=e:this.T(S.createTextNode(e)),this._$AH=e}$(e){var t;const{values:n,_$litType$:r}=e,i="number"==typeof r?this._$AC(e):(void 0===r.el&&(r.el=F.createElement(r.h,this.options)),r);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===i)this._$AH.p(n);else{const e=new z(i,this),t=e.v(this.options);e.p(n),this.T(t),this._$AH=e}}_$AC(e){let t=U.get(e.strings);return void 0===t&&U.set(e.strings,t=new F(e)),t}k(e){T(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,r=0;for(const i of e)r===t.length?t.push(n=new V(this.S(k()),this.S(k()),this,this.options)):n=t[r],n._$AI(i),r++;r<t.length&&(this._$AR(n&&n._$AB.nextSibling,r),t.length=r)}_$AR(e=this._$AA.nextSibling,t){var n;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cm=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class G{constructor(e,t,n,r,i){this.type=1,this._$AH=q,this._$AN=void 0,this.element=e,this.name=t,this._$AM=r,this.options=i,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=q}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,n,r){const i=this.strings;let s=!1;if(void 0===i)e=W(this,e,t,0),s=!x(e)||e!==this._$AH&&e!==D,s&&(this._$AH=e);else{const r=e;let o,a;for(e=i[0],o=0;o<i.length-1;o++)a=W(this,r[n+o],t,o),a===D&&(a=this._$AH[o]),s||(s=!x(a)||a!==this._$AH[o]),a===q?e=q:e!==q&&(e+=(null!=a?a:"")+i[o+1]),this._$AH[o]=a}s&&!r&&this.j(e)}j(e){e===q?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class J extends G{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===q?void 0:e}}const Y=_?_.emptyScript:"";class Z extends G{constructor(){super(...arguments),this.type=4}j(e){e&&e!==q?this.element.setAttribute(this.name,Y):this.element.removeAttribute(this.name)}}class K extends G{constructor(e,t,n,r,i){super(e,t,n,r,i),this.type=5}_$AI(e,t=this){var n;if((e=null!==(n=W(this,e,t,0))&&void 0!==n?n:q)===D)return;const r=this._$AH,i=e===q&&r!==q||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,s=e!==q&&(r===q||i);i&&this.element.removeEventListener(this.name,this,r),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==n?n:this.element,e):this._$AH.handleEvent(e)}}class X{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){W(this,e)}}const Q=b.litHtmlPolyfillSupport;null==Q||Q(F,V),(null!==(y=b.litHtmlVersions)&&void 0!==y?y:b.litHtmlVersions=[]).push("2.7.0");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var ee,te;class ne extends v{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const n=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=n.firstChild),n}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,n)=>{var r,i;const s=null!==(r=null==n?void 0:n.renderBefore)&&void 0!==r?r:t;let o=s._$litPart$;if(void 0===o){const e=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:null;s._$litPart$=o=new V(t.insertBefore(k(),e),e,void 0,null!=n?n:{})}return o._$AI(e),o})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return D}}ne.finalized=!0,ne._$litElement$=!0,null===(ee=globalThis.litElementHydrateSupport)||void 0===ee||ee.call(globalThis,{LitElement:ne});const re=globalThis.litElementPolyfillSupport;null==re||re({LitElement:ne}),(null!==(te=globalThis.litElementVersions)&&void 0!==te?te:globalThis.litElementVersions=[]).push("3.3.0");const ie="cell-view",se="data-attr",oe="data-cell",ae="data-bind",le="data-bind-set";class ce{constructor(e,t,n){this.runtime=e,this.name=t,this.value=n,this.paused=!1,this.ignore=null,this.queued=[],this.inputs=new Map,e.variable(null,(e=>e),[t],{fulfilled:e=>this.paused?this.dequeue():this.update(e)})}add(e,{override:t=!1,event:n=de(e),valueof:r=ue}={}){t?this.update(r(e)):r(e,this.value);const i=()=>this.queue(e,r(e));return this.inputs.set(e,{input:e,event:n,listener:i,valueof:r}),e.addEventListener(n,i),this}addCell(e,t){let n;return e.addEventListener("change",(async()=>{const r=e.value;r!==n&&(n&&this.delete(n),this.add(n=r,t))})),this}delete(e){const{event:t,listener:n}=this.inputs.get(e);e.removeEventListener(t,n),this.inputs.delete(e)}queue(e,t){this.ignore!==e&&(this.paused||this.queued.length||function(e){"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,0)}((()=>this.dequeue())),this.queued.push(t))}dequeue(){if(this.paused=!1,this.queued.length){const e=this.queued;this.queued=[],this.update(e.pop())}}update(e){if(this.value!==e){this.value=e,this.paused=!0;for(const{input:t,event:n,valueof:r}of this.inputs.values())r(t)!==e&&(this.ignore=t,r(t,e),t.dispatchEvent(new Event(n)),this.ignore=null);this.runtime.redefine(this.name,e)}}}function ue(e,t){if(arguments.length>1)switch(e.type){case"date":return e.valueAsDate=t;case"checkbox":return e.checked=t;default:return e.value=t}else switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;default:return e.value}}function de(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";default:return"input"}}const he="pending",fe="fulfilled",pe="rejected";class me{constructor(e){this.status=he,this.value=void 0,this.callback=e}promise(){switch(this.status){case fe:return Promise.resolve(this.value);case pe:return Promise.reject(this.value.error);case he:return this._promise||(this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t})))}}update(e,t){this.status=e,e!==he&&(this.value=t),this.callback(this.status,this.value)}pending(){this.update(he,void 0)}fulfilled(e){this.update(fe,e),this._promise&&(this._resolve(e),this._promise=this._resolve=this._reject=null)}rejected(e,t){this.update(pe,{error:e,name:t}),this._promise&&(this._reject(e),this._promise=this._resolve=this._reject=null)}}function ve(e,t,n,r={}){const{cells:i=(()=>[]),attrs:s=(()=>[]),event:o=(()=>[])}=n,a=function(e){const t=new Map;return e.querySelectorAll(`[${se}]`).forEach((e=>{t.set(e.getAttribute(se),e)})),e=>"object"==typeof e?e:t.get(e)}(t);e.define(i(),function(e){const t=new Map;return e.querySelectorAll(ie).forEach((e=>{t.set(+e.getAttribute(oe),e.observer)})),e=>t.get(e.cell)}(t)),e.define(s(),function(e,t){return n=>{const[r,i]=t[n.cell],s=e(r),o=new me(((e,t)=>{e===fe?s.setAttribute(i,t):e===pe&&console.error(t.error)}));return s.observers=s.observers||new Map,s.observers.set(i,o),o}}(a,r.attrs)),e.define(o(),function(e,t,n){return r=>{const{define:[i],cell:s}=r,[o,a]=t[s];return e(o).addEventListener(a,n.handler(i)),{rejected(e){console.error(e)}}}}(a,r.events,e)),function(e,t){const n=new Map,r=(t,r)=>{e.querySelectorAll(`[${t}]`).forEach((e=>{const i=e.getAttribute(t),s={el:e,override:r};n.has(i)?n.get(i).push(s):n.set(i,[s])}))};r(ae,!1),r(le,!0);const i=(e,{el:t,override:n})=>{t.tagName.toLowerCase()===ie?e.addCell(t,{override:n}):e.add(t,{override:n})};n.forEach(((e,n)=>{(async function(e,t){return new ce(e,t,await e.value(t))})(t,n).then((t=>{e.forEach((e=>i(t,e)))}))}))}(t,e)}const{getPrototypeOf:ye,getOwnPropertyDescriptors:be}=Object;ye({});var _e={},we={};function ge(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Ae(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function Ee(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function $e(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+Ee(-t,6):t>9999?"+"+Ee(t,6):Ee(t,4))+"-"+Ee(e.getUTCMonth()+1,2)+"-"+Ee(e.getUTCDate(),2)+(s?"T"+Ee(n,2)+":"+Ee(r,2)+":"+Ee(i,2)+"."+Ee(s,3)+"Z":i?"T"+Ee(n,2)+":"+Ee(r,2)+":"+Ee(i,2)+"Z":r||n?"T"+Ee(n,2)+":"+Ee(r,2)+"Z":"")}function Se(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],s=e.length,o=0,a=0,l=s<=0,c=!1;function u(){if(l)return we;if(c)return c=!1,_e;var t,r,i=o;if(34===e.charCodeAt(i)){for(;o++<s&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=s?l=!0:10===(r=e.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===e.charCodeAt(o)&&++o),e.slice(i+1,t-1).replace(/""/g,'"')}for(;o<s;){if(10===(r=e.charCodeAt(t=o++)))c=!0;else if(13===r)c=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(i,t)}return l=!0,e.slice(i,s)}for(10===e.charCodeAt(s-1)&&--s,13===e.charCodeAt(s-1)&&--s;(r=u())!==we;){for(var d=[];r!==_e&&r!==we;)d.push(r),r=u();t&&null==(d=t(d,a++))||i.push(d)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function s(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?$e(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,s=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=ge(e);return function(r,i){return t(n(r),i,e)}}(e,t):ge(e)}));return s.columns=i||[],s},parseRows:r,format:function(t,n){return null==n&&(n=Ae(t)),[n.map(o).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=Ae(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(s).join("\n")},formatRow:s,formatValue:o}}var ke=Se(","),xe=ke.parse,Te=ke.parseRows,Ce=Se("\t"),Ne=Ce.parse,Re=Ce.parseRows;function je(e){for(var t in e){var n,r,i=e[t].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Oe&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;e[t]=i}return e}const Oe=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function Me(e,t,n){return{resolve:(r=n)=>`${e}@${t}/${r}`}}const Ie=Me("d3","7.8.4","dist/d3.min.js"),Pe=Me("@observablehq/inputs","0.10.4","dist/inputs.min.js"),Le=Me("@observablehq/plot","0.6.5","dist/plot.umd.min.js"),De=Me("@observablehq/graphviz","0.2.1","dist/graphviz.min.js"),qe=Me("@observablehq/highlight.js","2.0.0","highlight.min.js"),Ue=Me("@observablehq/katex","0.11.1","dist/katex.min.js"),Be=Me("lodash","4.17.21","lodash.min.js"),He=Me("htl","0.3.1","dist/htl.min.js"),Fe=Me("jszip","3.10.1","dist/jszip.min.js"),We=Me("marked","0.3.12","marked.min.js"),ze=Me("sql.js","1.8.0","dist/sql-wasm.js"),Ve=Me("vega","5.22.1","build/vega.min.js"),Ge=Me("vega-lite","5.6.0","build/vega-lite.min.js"),Je=Me("vega-lite-api","5.0.0","build/vega-lite-api.min.js"),Ye=Me("apache-arrow","4.0.1","Arrow.es2015.min.js"),Ze=Me("apache-arrow","9.0.0","+esm"),Ke=Me("apache-arrow","11.0.0","+esm"),Xe=Me("arquero","4.8.8","dist/arquero.min.js"),Qe=Me("topojson-client","3.1.0","dist/topojson-client.min.js"),et=Me("exceljs","4.3.0","dist/exceljs.min.js"),tt=Me("mermaid","9.2.2","dist/mermaid.min.js"),nt=Me("leaflet","1.9.3","dist/leaflet.js"),rt=Me("@duckdb/duckdb-wasm","1.24.0","+esm"),it=new Map,st=[],ot=st.map,at=st.some,lt=st.hasOwnProperty,ct=/^((?:@[^/@]+\/)?[^/@]+)(?:@([^/]+))?(?:\/(.*))?$/,ut=/^\d+\.\d+\.\d+(-[\w-.+]+)?$/,dt=/(?:\.[^/]*|\/)$/;class ht extends Error{constructor(e){super(e)}}function ft(e){const t=ct.exec(e);return t&&{name:t[1],version:t[2],path:t[3]}}function pt(e="https://cdn.jsdelivr.net/npm/",t=["unpkg","jsdelivr","browser","main"]){if(!/\/$/.test(e))throw new Error("origin lacks trailing slash");function n(t){const n=`${e}${t.name}${t.version?`@${t.version}`:""}/package.json`;let r=it.get(n);return r||it.set(n,r=fetch(n).then((e=>{if(!e.ok)throw new ht("unable to load package.json");return e.redirected&&!it.has(e.url)&&it.set(e.url,r),e.json()}))),r}return async function(r,i){if(r.startsWith(e)&&(r=r.substring(e.length)),/^(\w+:)|\/\//i.test(r))return r;if(/^[.]{0,2}\//i.test(r))return new URL(r,i??location).href;if(!r.length||/^[\s._]/.test(r)||/\s$/.test(r))throw new ht("illegal name");const s=ft(r);if(!s)return`${e}${r}`;if(!s.version&&null!=i&&i.startsWith(e)){const t=await n(ft(i.substring(e.length)));s.version=t.dependencies&&t.dependencies[s.name]||t.peerDependencies&&t.peerDependencies[s.name]}if(s.path&&!dt.test(s.path)&&(s.path+=".js"),s.path&&s.version&&ut.test(s.version))return`${e}${s.name}@${s.version}/${s.path}`;const o=await n(s);return`${e}${o.name}@${o.version}/${s.path||function(e){for(const n of t){let t=e[n];if("string"==typeof t)return t.startsWith("./")&&(t=t.slice(2)),dt.test(t)?t:`${t}.js`}}(o)||"index.js"}`}}ht.prototype.name=ht.name;var mt=vt(pt());function vt(e){const t=new Map,n=i(null);function r(e){if("string"!=typeof e)return e;let n=t.get(e);return n||t.set(e,n=new Promise(((t,n)=>{const r=document.createElement("script");r.onload=()=>{try{t(st.pop()(i(e)))}catch(e){n(new ht("invalid module"))}r.remove()},r.onerror=()=>{n(new ht("unable to load module")),r.remove()},r.async=!0,r.src=e,window.define=wt,document.head.appendChild(r)}))),n}function i(t){return n=>Promise.resolve(e(n,t)).then(r)}function s(e){return arguments.length>1?Promise.all(ot.call(arguments,n)).then(yt):n(e)}return s.alias=function(t){return vt(((n,r)=>n in t&&(r=null,"string"!=typeof(n=t[n]))?n:e(n,r)))},s.resolve=e,s}function yt(e){const t={};for(const n of e)for(const e in n)lt.call(n,e)&&(null==n[e]?Object.defineProperty(t,e,{get:bt(n,e)}):t[e]=n[e]);return t}function bt(e,t){return()=>e[t]}function _t(e){return"exports"===(e+="")||"module"===e}function wt(e,t,n){const r=arguments.length;r<2?(n=e,t=[]):r<3&&(n=t,t="string"==typeof e?[]:e),st.push(at.call(t,_t)?e=>{const r={},i={exports:r};return Promise.all(ot.call(t,(t=>"exports"===(t+="")?r:"module"===t?i:e(t)))).then((e=>(n.apply(null,e),i.exports)))}:e=>Promise.all(ot.call(t,e)).then((e=>"function"==typeof n?n.apply(null,e):n)))}wt.amd={};const gt="https://cdn.observableusercontent.com/npm/";let At,Et=mt;async function $t(e){const[t,n]=await Promise.all([e(ze.resolve()),e.resolve(ze.resolve("dist/"))]);return t({locateFile:e=>`${n}${e}`})}class St{constructor(e){Object.defineProperties(this,{_db:{value:e}})}static async open(e){const[t,n]=await Promise.all([$t(Et),Promise.resolve(e).then(xt)]);return new St(new t.Database(n))}async query(e,t){return await async function(e,t,n){const[r]=await e.exec(t,n);if(!r)return[];const{columns:i,values:s}=r,o=s.map((e=>Object.fromEntries(e.map(((e,t)=>[i[t],e])))));return o.columns=i,o}(this._db,e,t)}async queryRow(e,t){return(await this.query(e,t))[0]||null}async explain(e,t){return Tt("pre",{className:"observablehq--inspect"},[Ct((await this.query(`EXPLAIN QUERY PLAN ${e}`,t)).map((e=>e.detail)).join("\n"))])}async describeTables({schema:e}={}){return this.query(`SELECT NULLIF(schema, 'main') AS schema, name FROM pragma_table_list() WHERE type = 'table'${null==e?"":" AND schema = ?"} AND name NOT LIKE 'sqlite_%' ORDER BY schema, name`,null==e?[]:[e])}async describeColumns({schema:e,table:t}={}){if(null==t)throw new Error("missing table");const n=await this.query(`SELECT name, type, "notnull" FROM pragma_table_info(?${null==e?"":", ?"}) ORDER BY cid`,null==e?[t]:[t,e]);if(!n.length)throw new Error(`table not found: ${t}`);return n.map((({name:e,type:t,notnull:n})=>({name:e,type:kt(t),databaseType:t,nullable:!n})))}async describe(e){const t=await(void 0===e?this.query("SELECT name FROM sqlite_master WHERE type = 'table'"):this.query("SELECT * FROM pragma_table_info(?)",[e]));if(!t.length)throw new Error("Not found");const{columns:n}=t;return Tt("table",{value:t},[Tt("thead",[Tt("tr",n.map((e=>Tt("th",[Ct(e)]))))]),Tt("tbody",t.map((e=>Tt("tr",n.map((t=>Tt("td",[Ct(e[t])])))))))])}async sql(){return this.query(...this.queryTag.apply(this,arguments))}queryTag(e,...t){return[e.join("?"),t]}}function kt(e){switch(e){case"NULL":return"null";case"INT":case"INTEGER":case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"BIGINT":case"UNSIGNED BIG INT":case"INT2":case"INT8":return"integer";case"TEXT":case"CLOB":case"DATE":case"DATETIME":return"string";case"REAL":case"DOUBLE":case"DOUBLE PRECISION":case"FLOAT":case"NUMERIC":return"number";case"BLOB":return"buffer";default:return/^(?:(?:(?:VARYING|NATIVE) )?CHARACTER|(?:N|VAR|NVAR)CHAR)\(/.test(e)?"string":/^(?:DECIMAL|NUMERIC)\(/.test(e)?"number":"other"}}function xt(e){return"string"==typeof e?fetch(e).then(xt):e instanceof Response||e instanceof Blob?e.arrayBuffer().then(xt):e instanceof ArrayBuffer?new Uint8Array(e):e}function Tt(e,t,n){2===arguments.length&&(n=t,t=void 0);const r=document.createElement(e);if(void 0!==t)for(const e in t)r[e]=t[e];if(void 0!==n)for(const e of n)r.appendChild(e);return r}function Ct(e){return document.createTextNode(e)}function Nt(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Rt(e,t=Nt){let n,r=!1;if(1===t.length){let i;for(const s of e){const e=t(s);(r?Nt(e,i)>0:0===Nt(e,e))&&(n=s,i=e,r=!0)}}else for(const i of e)(r?t(i,n)>0:0===t(i,i))&&(n=i,r=!0);return n}function jt(e){return e&&"function"==typeof e.toArrowBuffer}function Ot(e){return e&&"function"==typeof e.getChild&&"function"==typeof e.toArray&&e.schema&&Array.isArray(e.schema.fields)}function Mt(e){return{name:e.name,type:It(e.type),nullable:e.nullable,databaseType:String(e.type)}}function It(e){switch(e.typeId){case 2:return"integer";case 3:case 7:return"number";case 4:case 15:return"buffer";case 5:return"string";case 6:return"boolean";case 8:case 9:case 10:return"date";case 12:case 16:return"array";case 13:case 14:return"object";default:return"other"}}async function Pt(){return await import(`${gt}${Ke.resolve()}`)}Object.defineProperty(St.prototype,"dialect",{value:"sqlite"});class Lt{constructor(e){Object.defineProperties(this,{_db:{value:e}})}async queryStream(e,t){const n=await this._db.connect();let r,i;try{if(t?.length>0){const i=await n.prepare(e);r=await i.send(...t)}else r=await n.send(e);if(i=await r.next(),i.done)throw new Error("missing first batch")}catch(e){throw await n.close(),e}return{schema:(s=i.value,s.schema.fields.map(Mt)),async*readRows(){try{for(;!i.done;)yield i.value.toArray(),i=await r.next()}finally{await n.close()}}};var s}async query(e,t){const n=await this.queryStream(e,t),r=[];for await(const e of n.readRows())for(const t of e)r.push(t);return r.schema=n.schema,r}async queryRow(e,t){const n=(await this.queryStream(e,t)).readRows();try{const{done:e,value:t}=await n.next();return e||!t.length?null:t[0]}finally{await n.return()}}async sql(e,...t){return await this.query(e.join("?"),t)}queryTag(e,...t){return[e.join("?"),t]}escape(e){return`"${e}"`}async describeTables(){return(await this.query("SHOW TABLES")).map((({name:e})=>({name:e})))}async describeColumns({table:e}={}){return(await this.query(`DESCRIBE ${this.escape(e)}`)).map((({column_name:e,column_type:t,null:n})=>({name:e,type:Bt(t),nullable:"NO"!==n,databaseType:t})))}static async of(e={},t={}){const n=await async function(){void 0===At&&(At=async function(){const e=await import(`${gt}${rt.resolve()}`),t=await e.selectBundle({mvp:{mainModule:`${gt}${rt.resolve("dist/duckdb-mvp.wasm")}`,mainWorker:`${gt}${rt.resolve("dist/duckdb-browser-mvp.worker.js")}`},eh:{mainModule:`${gt}${rt.resolve("dist/duckdb-eh.wasm")}`,mainWorker:`${gt}${rt.resolve("dist/duckdb-browser-eh.worker.js")}`}}),n=new e.ConsoleLogger;return{module:e,bundle:t,logger:n}}());const{module:e,bundle:t,logger:n}=await At,r=await e.createWorker(t.mainWorker),i=new e.AsyncDuckDB(n,r);return await i.instantiate(t.mainModule),i}();return void 0===t.query?.castTimestampToDate&&(t={...t,query:{...t.query,castTimestampToDate:!0}}),void 0===t.query?.castBigIntToDouble&&(t={...t,query:{...t.query,castBigIntToDouble:!0}}),await n.open(t),await Promise.all(Object.entries(e).map((async([e,t])=>{if(t instanceof Pn)await Dt(n,e,t);else if(Ot(t))await qt(n,e,t);else if(Array.isArray(t))await Ut(n,e,t);else if(jt(t))await async function(e,t,n){const r=(await Pt()).tableFromIPC(n.toArrowBuffer());return await qt(e,t,r)}(n,e,t);else if("data"in t){const{data:r,...i}=t;Ot(r)?await qt(n,e,r,i):await Ut(n,e,r,i)}else{if(!("file"in t))throw new Error(`invalid source: ${t}`);{const{file:r,...i}=t;await Dt(n,e,r,i)}}}))),new Lt(n)}}async function Dt(e,t,n,r){const i=await n.url();if(i.startsWith("blob:")){const t=await n.arrayBuffer();await e.registerFileBuffer(n.name,new Uint8Array(t))}else await e.registerFileURL(n.name,i,4);const s=await e.connect();try{switch(n.mimeType){case"text/csv":case"text/tab-separated-values":return await s.insertCSVFromPath(n.name,{name:t,schema:"main",...r}).catch((async e=>{if(e.toString().includes("Could not convert"))return await async function(e,t,n){const r=await e.prepare(`CREATE TABLE '${n}' AS SELECT * FROM read_csv_auto(?, ALL_VARCHAR=TRUE)`);return await r.send(t.name)}(s,n,t);throw e}));case"application/json":return await s.insertJSONFromPath(n.name,{name:t,schema:"main",...r});default:if(/\.arrow$/i.test(n.name)){const e=new Uint8Array(await n.arrayBuffer());return await s.insertArrowFromIPCStream(e,{name:t,schema:"main",...r})}if(/\.parquet$/i.test(n.name))return await s.query(`CREATE VIEW '${t}' AS SELECT * FROM parquet_scan('${n.name}')`);throw new Error(`unknown file type: ${n.mimeType}`)}}finally{await s.close()}}async function qt(e,t,n,r){const i=await e.connect();try{await i.insertArrowTable(n,{name:t,schema:"main",...r})}finally{await i.close()}}async function Ut(e,t,n,r){const i=(await Pt()).tableFromJSON(n);return await qt(e,t,i,r)}function Bt(e){switch(e){case"BIGINT":case"HUGEINT":case"UBIGINT":return"bigint";case"DOUBLE":case"REAL":case"FLOAT":return"number";case"INTEGER":case"SMALLINT":case"TINYINT":case"USMALLINT":case"UINTEGER":case"UTINYINT":return"integer";case"BOOLEAN":return"boolean";case"DATE":case"TIMESTAMP":case"TIMESTAMP WITH TIME ZONE":return"date";case"VARCHAR":case"UUID":return"string";default:return/^DECIMAL\(/.test(e)?"integer":"other"}}Object.defineProperty(Lt.prototype,"dialect",{value:"duckdb"});const Ht=20;function Ft(e){return Array.isArray(e)&&(Wt(e.schema)||zt(e.columns)||function(e){const t=Math.min(Ht,e.length);for(let n=0;n<t;++n){const t=e[n];if(null===t||"object"!=typeof t)return!1}return t>0&&function(e){for(const t in e)return!0;return!1}(e[0])}(e)||Jt(e)||Yt(e))||Zt(e)}function Wt(e){return Array.isArray(e)&&e.every(Vt)}function zt(e){return Array.isArray(e)&&e.every((e=>"string"==typeof e))}function Vt(e){return e&&"string"==typeof e.name&&"string"==typeof e.type}function Gt(e){return Zt(e)||Jt(e)||Yt(e)}function Jt(e){const t=Math.min(Ht,e.length);if(!(t>0))return!1;let n,r=!1;for(let i=0;i<t;++i){const t=e[i];if(null==t)continue;const s=typeof t;if(void 0===n)switch(s){case"number":case"boolean":case"string":case"bigint":n=s;break;default:return!1}else if(s!==n)return!1;r=!0}return r}function Yt(e){const t=Math.min(Ht,e.length);if(!(t>0))return!1;let n=!1;for(let r=0;r<t;++r){const t=e[r];if(null!=t){if(!(t instanceof Date))return!1;n=!0}}return n}function Zt(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}const Kt=Object.assign((async(e,t,n,r)=>{if(e=await Qt(await e,r),(i=e)&&("function"==typeof i.sql||"function"==typeof i.queryTag&&("function"==typeof i.query||"function"==typeof i.queryStream))&&("table"!==s||"function"==typeof i.describeColumns)&&i!==Kt)return nn(e,function(e,t){const n="function"==typeof t.escape?t.escape:e=>e,{select:r,from:i,filter:s,sort:o,slice:a}=e;if(!i.table)throw new Error("missing from table");if(r.columns&&0===r.columns.length)throw new Error("at least one column must be selected");const l=new Map(e.names?.map((({column:e,name:t})=>[e,t]))),c=r.columns?r.columns.map((e=>{const t=l.get(e);return t?`${n(e)} AS ${n(t)}`:n(e)})).join(", "):"*",u=[[`SELECT ${c} FROM ${rn(i.table,n)}`]];for(let e=0;e<s.length;++e)sn(e?"\nAND ":"\nWHERE ",u),an(s[e],u,n);for(let e=0;e<o.length;++e)sn(e?", ":"\nORDER BY ",u),on(o[e],u,n);if("mssql"===t.dialect||"oracle"===t.dialect){if(null!==a.to||null!==a.from){if(!o.length){if(!r.columns)throw new Error("at least one column must be explicitly specified. Received '*'.");sn("\nORDER BY ",u),on({column:r.columns[0],direction:"ASC"},u,n)}sn(`\nOFFSET ${a.from||0} ROWS`,u),sn(`\nFETCH NEXT ${null!==a.to?a.to-(a.from||0):1e9} ROWS ONLY`,u)}}else null===a.to&&null===a.from||sn("\nLIMIT "+(null!==a.to?a.to-(a.from||0):1e9),u),null!==a.from&&sn(` OFFSET ${a.from}`,u);return u}(t,e),n);var i,s;if(Ft(e))return function(e,t){const n=e;let{schema:r,columns:i}=e,s=!1;Wt(r)||(r=xn(e,zt(i)?i:void 0),s=!0);const o=new Map(r.map((({name:e,type:t})=>[e,t])));if(t.types){for(const{name:e,type:i}of t.types){o.set(e,i),r===n.schema&&(r=r.slice());const t=r.findIndex((t=>t.name===e));t>-1&&(r[t]={...r[t],type:i})}e=e.map((e=>Sn(e,o,r)))}else s&&(e=e.map((e=>Sn(e,o,r))));for(const{type:n,operands:r}of t.filter){const[{value:t}]=r,i=r.slice(1).map((({value:e})=>e));switch(n){case"v":{const[n]=i,r=An(n);e=e.filter((e=>r(e[t])));break}case"nv":{const[n]=i,r=An(n);e=e.filter((e=>!r(e[t])));break}case"eq":{const[n]=i;if(n instanceof Date){const r=+n;e=e.filter((e=>+e[t]===r))}else e=e.filter((e=>e[t]===n));break}case"ne":{const[n]=i;e=e.filter((e=>e[t]!==n));break}case"c":{const[n]=i;e=e.filter((e=>"string"==typeof e[t]&&e[t].includes(n)));break}case"nc":{const[n]=i;e=e.filter((e=>"string"==typeof e[t]&&!e[t].includes(n)));break}case"in":{const n=new Set(i);e=e.filter((e=>n.has(e[t])));break}case"nin":{const n=new Set(i);e=e.filter((e=>!n.has(e[t])));break}case"n":e=e.filter((e=>null==e[t]));break;case"nn":e=e.filter((e=>null!=e[t]));break;case"lt":{const[n]=i;e=e.filter((e=>e[t]<n));break}case"lte":{const[n]=i;e=e.filter((e=>e[t]<=n));break}case"gt":{const[n]=i;e=e.filter((e=>e[t]>n));break}case"gte":{const[n]=i;e=e.filter((e=>e[t]>=n));break}default:throw new Error(`unknown filter type: ${n}`)}}for(const{column:r,direction:i}of function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()}(t.sort)){const t="desc"===i?dn:un;e===n&&(e=e.slice()),e.sort(((e,n)=>t(e[r],n[r])))}let{from:a,to:l}=t.slice;a=null==a?0:Math.max(0,a),l=null==l?1/0:Math.max(0,l),(a>0||l<1/0)&&(e=e.slice(Math.max(0,a),Math.max(0,l)));if(t.select.columns){if(r){const e=new Map(r.map((e=>[e.name,e])));r=t.select.columns.map((t=>e.get(t)))}i&&(i=t.select.columns),e=e.map((e=>Object.fromEntries(t.select.columns.map((t=>[t,e[t]])))))}if(t.names){const n=new Map(t.names.map((e=>[e.column,e])));r&&(r=r.map((e=>{const t=n.get(e.name);return{...e,...t?{name:t.name}:null}}))),i&&(i=i.map((e=>{const t=n.get(e);return t?.name??e}))),e=e.map((e=>Object.fromEntries(Object.keys(e).map((t=>{const r=n.get(t);return[r?.name??t,e[t]]})))))}e!==n&&(r&&(e.schema=r),i&&(e.columns=i));return e}(e,t);if(!e)throw new Error("missing data source");throw new Error("invalid data source")}),{sql:(e,t,n)=>async function(){return nn(await en(await e,n),arguments,t)}});function Xt(e){const t=new WeakMap;return(n,r)=>{if(!n)throw new Error("data source not found");let i=t.get(n);return(!i||Ft(n)&&n.length!==i._numRows)&&(i=e(n,r),i._numRows=n.length,t.set(n,i)),i}}const Qt=Xt((async(e,t)=>{if(e instanceof Pn){switch(e.mimeType){case"text/csv":return e.csv();case"text/tab-separated-values":return e.tsv();case"application/json":return e.json();case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return tn(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return Ot(e)||jt(e)?tn(e,t):Ft(e)&&Gt(e)?Array.from(e,(e=>({value:e}))):e})),en=Xt((async(e,t)=>{if(e instanceof Pn){switch(e.mimeType){case"text/csv":case"text/tab-separated-values":case"application/json":return tn(e,t);case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return tn(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return Ft(e)?tn(await async function(e,t){const n=await Pt();return Gt(e)?n.tableFromArrays({[t]:e}):n.tableFromJSON(e)}(e,t),t):Ot(e)||jt(e)?tn(e,t):e}));function tn(e,t=(e instanceof Pn?function(e){return e.name.replace(/@\d+(?=\.|$)/,"").replace(/\.\w+$/,"")}(e):"__table")){return Lt.of({[t]:e})}async function nn(e,t,n){if(!e)throw new Error("missing data source");if("function"==typeof e.queryTag){const r=new AbortController,i={signal:r.signal};if(n.then((()=>r.abort("invalidated"))),"function"==typeof e.queryStream)return async function*(e){let t=performance.now();const n=await e,r=[];r.done=!1,r.error=null,r.schema=n.schema;try{for await(const e of n.readRows()){performance.now()-t>150&&r.length>0&&(yield r,t=performance.now());for(const t of e)r.push(t)}r.done=!0,yield r}catch(e){r.error=e,yield r}}(e.queryStream(...e.queryTag.apply(e,t),i));if("function"==typeof e.query)return e.query(...e.queryTag.apply(e,t),i)}if("function"==typeof e.sql)return e.sql.apply(e,t);throw new Error("source does not implement query, queryStream, or sql")}function rn(e,t){if("object"==typeof e){let n="";return null!=e.database&&(n+=t(e.database)+"."),null!=e.schema&&(n+=t(e.schema)+"."),n+=t(e.table),n}return t(e)}function sn(e,t){const n=t[0];n[n.length-1]+=e}function on({column:e,direction:t},n,r){sn(`${r(e)} ${t.toUpperCase()}`,n)}function an({type:e,operands:t},n,r){if(t.length<1)throw new Error("Invalid operand length");if(1===t.length||"v"===e||"nv"===e)switch(ln(t[0],n,r),e){case"n":case"nv":return void sn(" IS NULL",n);case"nn":case"v":return void sn(" IS NOT NULL",n);default:throw new Error("Invalid filter operation")}if(2!==t.length||["in","nin"].includes(e)){var i;switch(ln(t[0],n,r),e){case"in":sn(" IN (",n);break;case"nin":sn(" NOT IN (",n);break;default:throw new Error("Invalid filter operation")}!function(e,t){let n=!0;for(const r of e)n?n=!1:sn(",",t),t.push(r.value),t[0].push("")}(t.slice(1),n),sn(")",n)}else{if(["c","nc"].includes(e)){switch(ln(t[0],n,r),e){case"c":sn(" LIKE ",n);break;case"nc":sn(" NOT LIKE ",n)}return void ln((i=t[1],{...i,value:`%${i.value}%`}),n,r)}switch(ln(t[0],n,r),e){case"eq":sn(" = ",n);break;case"ne":sn(" <> ",n);break;case"gt":sn(" > ",n);break;case"lt":sn(" < ",n);break;case"gte":sn(" >= ",n);break;case"lte":sn(" <= ",n);break;default:throw new Error("Invalid filter operation")}ln(t[1],n,r)}}function ln(e,t,n){"column"===e.type?sn(n(e.value),t):(t.push(e.value),t[0].push(""))}function cn(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))}function un(e,t){return cn(e,t)||(e<t?-1:e>t?1:0)}function dn(e,t){return cn(e,t)||(e>t?-1:e<t?1:0)}const hn=e=>"number"==typeof e&&!Number.isNaN(e),fn=e=>Number.isInteger(e)&&!Number.isNaN(e),pn=e=>"string"==typeof e,mn=e=>"boolean"==typeof e,vn=e=>"bigint"==typeof e,yn=e=>e instanceof Date&&!isNaN(e),bn=e=>e instanceof ArrayBuffer,_n=e=>Array.isArray(e),wn=e=>"object"==typeof e&&null!==e,gn=e=>null!=e;function An(e){switch(e){case"string":return pn;case"bigint":return vn;case"boolean":return mn;case"number":return hn;case"integer":return fn;case"date":return yn;case"buffer":return bn;case"array":return _n;case"object":return wn;default:return gn}}const En=/^(([-+]\d{2})?\d{4}(-\d{2}(-\d{2}))|(\d{1,2})\/(\d{1,2})\/(\d{2,4}))([T ]\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function $n(e,t){switch(t){case"string":return"string"==typeof e||null==e?e:String(e);case"boolean":if("string"==typeof e){const t=e.trim().toLowerCase();return"true"===t||"false"!==t&&null}return"boolean"==typeof e||null==e?e:Boolean(e);case"bigint":return"bigint"==typeof e||null==e?e:Number.isInteger("string"!=typeof e||e.trim()?+e:NaN)?BigInt(e):void 0;case"integer":case"number":return"number"==typeof e?e:null==e||"string"==typeof e&&!e.trim()?NaN:Number(e);case"date":{if(e instanceof Date||null==e)return e;if("number"==typeof e)return new Date(e);const t=String(e).trim();return"string"!=typeof e||t?new Date(En.test(t)?t:NaN):null}case"array":case"object":case"buffer":case"other":return e;default:throw new Error(`Unable to coerce to type: ${t}`)}}function Sn(e,t,n){const r={};for(const i of n){const n=t.get(i.name),s=e[i.name];r[i.name]="raw"===n?s:$n(s,n)}return r}const kn=["boolean","integer","number","date","bigint","array","object","buffer"];function xn(e,t=function(e){const t=new Set;for(const n of e)if(n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t.add(e);return Array.from(t)}(e)){const n=[],r=e.slice(0,100);for(const e of t){const t={boolean:0,integer:0,number:0,date:0,string:0,array:0,object:0,bigint:0,buffer:0,defined:0};for(const n of r){let r=n[e];if(null==r)continue;const i=typeof r;if("string"!==i)++t.defined,Array.isArray(r)?++t.array:r instanceof Date?++t.date:r instanceof ArrayBuffer?++t.buffer:"number"===i?(++t.number,Number.isInteger(r)&&++t.integer):i in t&&++t[i];else{if(r=r.trim(),!r)continue;++t.defined,++t.string,/^(true|false)$/i.test(r)?++t.boolean:r&&!isNaN(r)?(++t.number,Number.isInteger(+r)&&++t.integer):En.test(r)&&++t.date}}const i=Math.max(1,.9*t.defined),s=Rt(kn,(e=>t[e]>=i?t[e]:NaN))??(t.string>=i?"string":"other");n.push({name:e,type:s,inferred:s})}return n}class Tn{constructor(e){Object.defineProperties(this,{_:{value:e},sheetNames:{value:e.worksheets.map((e=>e.name)),enumerable:!0}})}sheet(e,t){const n="number"==typeof e?this.sheetNames[e]:this.sheetNames.includes(e+="")?e:null;if(null==n)throw new Error(`Sheet not found: ${e}`);return function(e,{range:t,headers:n}={}){let[[r,i],[s,o]]=function(e=":",{columnCount:t,rowCount:n}){if(!(e+="").match(/^[A-Z]*\d*:[A-Z]*\d*$/))throw new Error("Malformed range specifier");const[[r=0,i=0],[s=t-1,o=n-1]]=e.split(":").map(jn);return[[r,i],[s,o]]}(t,e);const a=n?e._rows[i++]:null;let l=new Set(["#"]);for(let e=r;e<=s;e++){const t=a?Cn(a.findCell(e+1)):null;let n=t&&t+""||Rn(e);for(;l.has(n);)n+="_";l.add(n)}l=new Array(r).concat(Array.from(l));const c=new Array(o-i+1);for(let t=i;t<=o;t++){const n=c[t-i]=Object.create(null,{"#":{value:t+1}}),o=e.getRow(t+1);if(o.hasValues)for(let e=r;e<=s;e++){const t=Cn(o.findCell(e+1));null!=t&&(n[l[e+1]]=t)}}return c.columns=l.filter((()=>!0)),c}(this._.getWorksheet(n),t)}}function Cn(e){if(!e)return;const{value:t}=e;if(t&&"object"==typeof t&&!(t instanceof Date)){if(t.formula||t.sharedFormula)return t.result&&t.result.error?NaN:t.result;if(t.richText)return Nn(t);if(t.text){let{text:e}=t;return e.richText&&(e=Nn(e)),t.hyperlink&&t.hyperlink!==e?`${t.hyperlink} ${e}`:e}return t}return t}function Nn(e){return e.richText.map((e=>e.text)).join("")}function Rn(e){let t="";e++;do{t=String.fromCharCode(64+(e%26||26))+t}while(e=Math.floor((e-1)/26));return t}function jn(e){const[,t,n]=e.match(/^([A-Z]*)(\d*)$/);let r=0;if(t)for(let e=0;e<t.length;e++)r+=Math.pow(26,t.length-e-1)*(t.charCodeAt(e)-64);return[r?r-1:void 0,n?+n-1:void 0]}async function On(e){const t=await fetch(await e.url());if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}async function Mn(e,t,{array:n=!1,typed:r=!1}={}){const i=await e.text(),s="\t"===t?n?Re:Ne:n?Te:xe;if("auto"===r&&!n){const e=s(i);return function(e,t){const n=new Map(t.map((({name:e,type:t})=>[e,t])));return Object.assign(e.map((e=>Sn(e,n,t))),{schema:t})}(e,xn(e,e.columns))}return s(i,r&&je)}class In{constructor(e,t){Object.defineProperty(this,"name",{value:e,enumerable:!0}),void 0!==t&&Object.defineProperty(this,"mimeType",{value:t+"",enumerable:!0})}async blob(){return(await On(this)).blob()}async arrayBuffer(){return(await On(this)).arrayBuffer()}async text(){return(await On(this)).text()}async json(){return(await On(this)).json()}async stream(){return(await On(this)).body}async csv(e){return Mn(this,",",e)}async tsv(e){return Mn(this,"\t",e)}async image(e){const t=await this.url();return new Promise(((n,r)=>{const i=new Image;new URL(t,document.baseURI).origin!==new URL(location).origin&&(i.crossOrigin="anonymous"),Object.assign(i,e),i.onload=()=>n(i),i.onerror=()=>r(new Error(`Unable to load file: ${this.name}`)),i.src=t}))}async arrow({version:e=4}={}){switch(e){case 4:{const[e,t]=await Promise.all([Et(Ye.resolve()),On(this)]);return e.Table.from(t)}case 9:{const[e,t]=await Promise.all([import(`${gt}${Ze.resolve()}`),On(this)]);return e.tableFromIPC(t)}case 11:{const[e,t]=await Promise.all([import(`${gt}${Ke.resolve()}`),On(this)]);return e.tableFromIPC(t)}default:throw new Error(`unsupported arrow version: ${e}`)}}async sqlite(){return St.open(On(this))}async zip(){const[e,t]=await Promise.all([Et(Fe.resolve()),this.arrayBuffer()]);return new Dn(await e.loadAsync(t))}async xml(e="application/xml"){return(new DOMParser).parseFromString(await this.text(),e)}async html(){return this.xml("text/html")}async xlsx(){const[e,t]=await Promise.all([Et(et.resolve()),this.arrayBuffer()]);return new Tn(await(new e.Workbook).xlsx.load(t))}}let Pn=class extends In{constructor(e,t,n){super(t,n),Object.defineProperty(this,"_url",{value:e})}async url(){return await this._url+""}};function Ln(e){throw new Error(`File not found: ${e}`)}class Dn{constructor(e){Object.defineProperty(this,"_",{value:e}),this.filenames=Object.keys(e.files).filter((t=>!e.files[t].dir))}file(e){const t=this._.file(e+="");if(!t||t.dir)throw new Error(`file not found: ${e}`);return new qn(t)}}class qn extends In{constructor(e){super(e.name),Object.defineProperty(this,"_",{value:e}),Object.defineProperty(this,"_url",{writable:!0})}async url(){return this._url||(this._url=this.blob().then(URL.createObjectURL))}async blob(){return this._.async("blob")}async arrayBuffer(){return this._.async("arraybuffer")}async text(){return this._.async("text")}async json(){return JSON.parse(await this.text())}}var Un={math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var Bn=0;function Hn(e){return new Fn("O-"+(null==e?"":e+"-")+ ++Bn)}function Fn(e){this.id=e,this.href=new URL(`#${e}`,location)+""}Fn.prototype.toString=function(){return"url("+this.href+")"};var Wn=Object.freeze({__proto__:null,canvas:function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n},context2d:function(e,t,n){null==n&&(n=devicePixelRatio);var r=document.createElement("canvas");r.width=e*n,r.height=t*n,r.style.width=e+"px";var i=r.getContext("2d");return i.scale(n,n),i},download:function(e,t="untitled",n="Save"){const r=document.createElement("a"),i=r.appendChild(document.createElement("button"));async function s(){await new Promise(requestAnimationFrame),URL.revokeObjectURL(r.href),r.removeAttribute("href"),i.textContent=n,i.disabled=!1}return i.textContent=n,r.download=t,r.onclick=async t=>{if(i.disabled=!0,r.href)return s();i.textContent="Saving";try{const t=await("function"==typeof e?e():e);i.textContent="Download",r.href=URL.createObjectURL(t)}catch(e){i.textContent=n}if(t.eventPhase)return s();i.disabled=!1},r},element:function(e,t){var n,r=e+="",i=r.indexOf(":");i>=0&&"xmlns"!==(r=e.slice(0,i))&&(e=e.slice(i+1));var s=Un.hasOwnProperty(r)?document.createElementNS(Un[r],e):document.createElement(e);if(t)for(var o in t)i=(r=o).indexOf(":"),n=t[o],i>=0&&"xmlns"!==(r=o.slice(0,i))&&(o=o.slice(i+1)),Un.hasOwnProperty(r)?s.setAttributeNS(Un[r],o,n):s.setAttribute(o,n);return s},input:function(e){var t=document.createElement("input");return null!=e&&(t.type=e),t},range:function(e,t,n){1===arguments.length&&(t=e,e=null);var r=document.createElement("input");return r.min=e=null==e?0:+e,r.max=t=null==t?1:+t,r.step=null==n?"any":n=+n,r.type="range",r},select:function(e){var t=document.createElement("select");return Array.prototype.forEach.call(e,(function(e){var n=document.createElement("option");n.value=n.textContent=e,t.appendChild(n)})),t},svg:function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",[0,0,e,t]),n.setAttribute("width",e),n.setAttribute("height",t),n},text:function(e){return document.createTextNode(e)},uid:Hn});var zn=Object.freeze({__proto__:null,buffer:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)}))},text:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsText(e)}))},url:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)}))}});function Vn(){return this}function Gn(e,t){let n=!1;if("function"!=typeof t)throw new Error("dispose is not a function");return{[Symbol.iterator]:Vn,next:()=>n?{done:!0}:(n=!0,{done:!1,value:e}),return:()=>(n=!0,t(e),{done:!0}),throw:()=>({done:n=!0})}}function Jn(e){let t,n,r=!1;const i=e((function(e){n?(n(e),n=null):r=!0;return t=e}));if(null!=i&&"function"!=typeof i)throw new Error("function"==typeof i.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:Vn,throw:()=>({done:!0}),return:()=>(null!=i&&i(),{done:!0}),next:function(){return{done:!1,value:r?(r=!1,Promise.resolve(t)):new Promise((e=>n=e))}}}}function Yn(e){switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;case"file":return e.multiple?e.files:e.files[0];case"select-multiple":return Array.from(e.selectedOptions,(e=>e.value));default:return e.value}}var Zn=Object.freeze({__proto__:null,disposable:Gn,filter:function*(e,t){for(var n,r=-1;!(n=e.next()).done;)t(n.value,++r)&&(yield n.value)},input:function(e){return Jn((function(t){var n=function(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}(e),r=Yn(e);function i(){t(Yn(e))}return e.addEventListener(n,i),void 0!==r&&t(r),function(){e.removeEventListener(n,i)}}))},map:function*(e,t){for(var n,r=-1;!(n=e.next()).done;)yield t(n.value,++r)},observe:Jn,queue:function(e){let t;const n=[],r=e((function(e){n.push(e),t&&(t(n.shift()),t=null);return e}));if(null!=r&&"function"!=typeof r)throw new Error("function"==typeof r.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:Vn,throw:()=>({done:!0}),return:()=>(null!=r&&r(),{done:!0}),next:function(){return{done:!1,value:n.length?Promise.resolve(n.shift()):new Promise((e=>t=e))}}}},range:function*(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n));++r<i;)yield e+r*n},valueAt:function(e,t){if(!(!isFinite(t=+t)||t<0||t!=t|0))for(var n,r=-1;!(n=e.next()).done;)if(++r===t)return n.value},worker:function(e){const t=URL.createObjectURL(new Blob([e],{type:"text/javascript"})),n=new Worker(t);return Gn(n,(()=>{n.terminate(),URL.revokeObjectURL(t)}))}});function Kn(e,t){return function(n){var r,i,s,o,a,l,c,u,d=n[0],h=[],f=null,p=-1;for(a=1,l=arguments.length;a<l;++a){if((r=arguments[a])instanceof Node)h[++p]=r,d+="\x3c!--o:"+p+"--\x3e";else if(Array.isArray(r)){for(c=0,u=r.length;c<u;++c)(i=r[c])instanceof Node?(null===f&&(h[++p]=f=document.createDocumentFragment(),d+="\x3c!--o:"+p+"--\x3e"),f.appendChild(i)):(f=null,d+=i);f=null}else d+=r;d+=n[a]}if(f=e(d),++p>0){for(s=new Array(p),o=document.createTreeWalker(f,NodeFilter.SHOW_COMMENT,null,!1);o.nextNode();)i=o.currentNode,/^o:/.test(i.nodeValue)&&(s[+i.nodeValue.slice(2)]=i);for(a=0;a<p;++a)(i=s[a])&&i.parentNode.replaceChild(h[a],i)}return 1===f.childNodes.length?f.removeChild(f.firstChild):11===f.nodeType?((i=t()).appendChild(f),i):f}}const Xn=Kn((function(e){var t=document.createElement("template");return t.innerHTML=e.trim(),document.importNode(t.content,!0)}),(function(){return document.createElement("span")}));function Qn(e){let t;Object.defineProperties(this,{generator:{value:Jn((e=>{t=e}))},value:{get:()=>e,set:n=>t(e=n)}}),void 0!==e&&t(e)}function*er(){for(;;)yield Date.now()}var tr=new Map;function nr(e,t){var n;return(n=tr.get(e=+e))?n.then((()=>t)):(n=Date.now())>=e?Promise.resolve(t):function(e,t){var n=new Promise((function(n){tr.delete(t);var r=t-e;if(!(r>0))throw new Error("invalid time");if(r>2147483647)throw new Error("too long to wait");setTimeout(n,r)}));return tr.set(t,n),n}(n,e).then((()=>t))}var rr=Object.freeze({__proto__:null,delay:function(e,t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))},tick:function(e,t){return nr(Math.ceil((Date.now()+1)/e)*e,t)},when:nr});function ir(e,t){if(/^(\w+:)|\/\//i.test(e))return e;if(/^[.]{0,2}\//i.test(e))return new URL(e,t??location).href;if(!e.length||/^[\s._]/.test(e)||/\s$/.test(e))throw new Error("illegal name");return"https://unpkg.com/"+e}const sr=Kn((function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.innerHTML=e.trim(),t}),(function(){return document.createElementNS("http://www.w3.org/2000/svg","g")}));var or=String.raw;function ar(e){return new Promise((function(t,n){var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onerror=n,r.onload=t,document.head.appendChild(r)}))}function lr(){return Jn((function(e){var t=e(document.body.clientWidth);function n(){var n=document.body.clientWidth;n!==t&&e(t=n)}return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}))}const cr=Object.assign(Object.defineProperties((function(e){const t=function(e){return null==e?Et:vt(e)}(e);var n;Object.defineProperties(this,(n={FileAttachment:()=>Ln,Mutable:()=>Qn,now:er,width:lr,dot:()=>t(De.resolve()),htl:()=>t(He.resolve()),html:()=>Xn,md:()=>function(e){return e(We.resolve()).then((function(t){return Kn((function(n){var r=document.createElement("div");r.innerHTML=t(n,{langPrefix:""}).trim();var i=r.querySelectorAll("pre code[class]");return i.length>0&&e(qe.resolve()).then((function(t){i.forEach((function(n){function r(){t.highlightBlock(n),n.parentNode.classList.add("observablehq--md-pre")}t.getLanguage(n.className)?r():e(qe.resolve("async-languages/index.js")).then((r=>{if(r.has(n.className))return e(qe.resolve("async-languages/"+r.get(n.className))).then((e=>{t.registerLanguage(n.className,e)}))})).then(r,r)}))})),r}),(function(){return document.createElement("div")}))}))}(t),svg:()=>sr,tex:()=>function(e){return Promise.all([e(Ue.resolve()),e.resolve(Ue.resolve("dist/katex.min.css")).then(ar)]).then((function(e){var t=e[0],n=r();function r(e){return function(){var n=document.createElement("div");return t.render(or.apply(String,arguments),n,e),n.removeChild(n.firstChild)}}return n.options=r,n.block=r({displayMode:!0}),n}))}(t),_:()=>t(Be.resolve()),aq:()=>t.alias({"apache-arrow":Ye.resolve()})(Xe.resolve()),Arrow:()=>t(Ye.resolve()),d3:()=>t(Ie.resolve()),DuckDBClient:()=>Lt,Inputs:()=>t(Pe.resolve()).then((e=>({...e,file:e.fileOf(In)}))),L:()=>async function(e){const t=await e(nt.resolve());if(!t._style){const n=document.createElement("link");n.rel="stylesheet",n.href=await e.resolve(nt.resolve("dist/leaflet.css")),t._style=document.head.appendChild(n)}return t}(t),mermaid:()=>async function(e){const t=await e(tt.resolve());return t.initialize({securityLevel:"loose",theme:"neutral"}),function(){const e=document.createElement("div");return e.innerHTML=t.render(Hn().id,String.raw.apply(String,arguments)),e.removeChild(e.firstChild)}}(t),Plot:()=>t(Le.resolve()),__query:()=>Kt,require:()=>t,resolve:()=>ir,SQLite:()=>$t(t),SQLiteDatabaseClient:()=>St,topojson:()=>t(Qe.resolve()),vl:()=>async function(e){const[t,n,r]=await Promise.all([Ve,Ge,Je].map((t=>e(t.resolve()))));return r.register(t,n)}(t),aapl:()=>new Pn("https://static.observableusercontent.com/files/3ccff97fd2d93da734e76829b2b066eafdaac6a1fafdec0faf6ebc443271cfc109d29e80dd217468fcb2aff1e6bffdc73f356cc48feb657f35378e6abbbb63b9").csv({typed:!0}),alphabet:()=>new Pn("https://static.observableusercontent.com/files/75d52e6c3130b1cae83cda89305e17b50f33e7420ef205587a135e8562bcfd22e483cf4fa2fb5df6dff66f9c5d19740be1cfaf47406286e2eb6574b49ffc685d").csv({typed:!0}),cars:()=>new Pn("https://static.observableusercontent.com/files/048ec3dfd528110c0665dfa363dd28bc516ffb7247231f3ab25005036717f5c4c232a5efc7bb74bc03037155cb72b1abe85a33d86eb9f1a336196030443be4f6").csv({typed:!0}),citywages:()=>new Pn("https://static.observableusercontent.com/files/39837ec5121fcc163131dbc2fe8c1a2e0b3423a5d1e96b5ce371e2ac2e20a290d78b71a4fb08b9fa6a0107776e17fb78af313b8ea70f4cc6648fad68ddf06f7a").csv({typed:!0}),diamonds:()=>new Pn("https://static.observableusercontent.com/files/87942b1f5d061a21fa4bb8f2162db44e3ef0f7391301f867ab5ba718b225a63091af20675f0bfe7f922db097b217b377135203a7eab34651e21a8d09f4e37252").csv({typed:!0}),flare:()=>new Pn("https://static.observableusercontent.com/files/a6b0d94a7f5828fd133765a934f4c9746d2010e2f342d335923991f31b14120de96b5cb4f160d509d8dc627f0107d7f5b5070d2516f01e4c862b5b4867533000").csv({typed:!0}),industries:()=>new Pn("https://static.observableusercontent.com/files/76f13741128340cc88798c0a0b7fa5a2df8370f57554000774ab8ee9ae785ffa2903010cad670d4939af3e9c17e5e18e7e05ed2b38b848ac2fc1a0066aa0005f").csv({typed:!0}),miserables:()=>new Pn("https://static.observableusercontent.com/files/31d904f6e21d42d4963ece9c8cc4fbd75efcbdc404bf511bc79906f0a1be68b5a01e935f65123670ed04e35ca8cae3c2b943f82bf8db49c5a67c85cbb58db052").json(),olympians:()=>new Pn("https://static.observableusercontent.com/files/31ca24545a0603dce099d10ee89ee5ae72d29fa55e8fc7c9ffb5ded87ac83060d80f1d9e21f4ae8eb04c1e8940b7287d179fe8060d887fb1f055f430e210007c").csv({typed:!0}),penguins:()=>new Pn("https://static.observableusercontent.com/files/715db1223e067f00500780077febc6cebbdd90c151d3d78317c802732252052ab0e367039872ab9c77d6ef99e5f55a0724b35ddc898a1c99cb14c31a379af80a").csv({typed:!0}),weather:()=>new Pn("https://static.observableusercontent.com/files/693a46b22b33db0f042728700e0c73e836fa13d55446df89120682d55339c6db7cc9e574d3d73f24ecc9bc7eb9ac9a1e7e104a1ee52c00aab1e77eb102913c1f").csv({typed:!0}),DOM:Wn,Files:zn,Generators:Zn,Promises:rr},Object.fromEntries(Object.entries(n).map(ur))))}),{resolve:{get:()=>Et.resolve,enumerable:!0,configurable:!0},require:{get:()=>Et,set:function(e){Et=e},enumerable:!0,configurable:!0}}),{resolveFrom:pt,requireFrom:vt});function ur([e,t]){return[e,{value:t,writable:!0,enumerable:!0}]}class dr extends Error{constructor(e,t){super(e),this.input=t}}function hr(e){return()=>e}function fr(e){return e}dr.prototype.name="RuntimeError";const pr=Array.prototype.map;function mr(){}const vr=1,yr=2,br=3,_r=Symbol("no-observer");function wr(e,t,n){var r;n||(n=_r),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:Er,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:mr,writable:!0},_module:{value:t},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:Promise.resolve(void 0),writable:!0},_reachable:{value:n!==_r,writable:!0},_rejector:{value:(r=this,e=>{if(e===$r)throw e;if(e===Er)throw new dr(`${r._name} is not defined`,r._name);if(e instanceof Error&&e.message)throw new dr(e.message,r._name);throw new dr(`${r._name} could not be resolved`,r._name)})},_type:{value:e},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}function gr(e){e._module._runtime._dirty.add(e),e._outputs.add(this)}function Ar(e){e._module._runtime._dirty.add(e),e._outputs.delete(this)}function Er(){throw Er}function $r(){throw $r}function Sr(e){return()=>{throw new dr(`${e} is defined more than once`)}}function kr(e,t,n){const r=this._module._scope,i=this._module._runtime;if(this._inputs.forEach(Ar,this),t.forEach(gr,this),this._inputs=t,this._definition=n,this._value=void 0,n===mr?i._variables.delete(this):i._variables.add(this),e!==this._name||r.get(e)!==this){let t,s;if(this._name)if(this._outputs.size)r.delete(this._name),s=this._module._resolve(this._name),s._outputs=this._outputs,this._outputs=new Set,s._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(this)]=s}),this),s._outputs.forEach(i._updates.add,i._updates),i._dirty.add(s).add(this),r.set(this._name,s);else if((s=r.get(this._name))===this)r.delete(this._name);else{if(s._type!==br)throw new Error;s._duplicates.delete(this),this._duplicate=void 0,1===s._duplicates.size&&(s=s._duplicates.keys().next().value,t=r.get(this._name),s._outputs=t._outputs,t._outputs=new Set,s._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(t)]=s})),s._definition=s._duplicate,s._duplicate=void 0,i._dirty.add(t).add(s),i._updates.add(s),r.set(this._name,s))}if(this._outputs.size)throw new Error;e&&((s=r.get(e))?s._type===br?(this._definition=Sr(e),this._duplicate=n,s._duplicates.add(this)):s._type===yr?(this._outputs=s._outputs,s._outputs=new Set,this._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(s)]=this}),this),i._dirty.add(s).add(this),r.set(e,this)):(s._duplicate=s._definition,this._duplicate=n,t=new wr(br,this._module),t._name=e,t._definition=this._definition=s._definition=Sr(e),t._outputs=s._outputs,s._outputs=new Set,t._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(s)]=t})),t._duplicates=new Set([this,s]),i._dirty.add(s).add(t),i._updates.add(s).add(t),r.set(e,t)):r.set(e,this)),this._name=e}return this._version>0&&++this._version,i._updates.add(this),i._compute(),this}Object.defineProperties(wr.prototype,{_pending:{value:function(){this._observer.pending&&this._observer.pending()},writable:!0,configurable:!0},_fulfilled:{value:function(e){this._observer.fulfilled&&this._observer.fulfilled(e,this._name)},writable:!0,configurable:!0},_rejected:{value:function(e){this._observer.rejected&&this._observer.rejected(e,this._name)},writable:!0,configurable:!0},define:{value:function(e,t,n){switch(arguments.length){case 1:n=e,e=t=null;break;case 2:n=t,"string"==typeof e?t=null:(t=e,e=null)}return kr.call(this,null==e?null:String(e),null==t?[]:pr.call(t,this._module._resolve,this._module),"function"==typeof n?n:hr(n))},writable:!0,configurable:!0},delete:{value:function(){return kr.call(this,null,[],mr)},writable:!0,configurable:!0},import:{value:function(e,t,n){arguments.length<3&&(n=t,t=e);return kr.call(this,String(t),[n._resolve(String(e))],fr)},writable:!0,configurable:!0}});const xr=Symbol("variable"),Tr=Symbol("invalidation"),Cr=Symbol("visibility");function Nr(e,t=[]){Object.defineProperties(this,{_runtime:{value:e},_scope:{value:new Map},_builtins:{value:new Map([["@variable",xr],["invalidation",Tr],["visibility",Cr],...t])},_source:{value:null,writable:!0}})}async function Rr(e,t){await e._compute();try{return await t._promise}catch(n){if(n===$r)return Rr(e,t);throw n}}function jr(e){return e._name}Object.defineProperties(Nr.prototype,{_resolve:{value:function(e){let t,n=this._scope.get(e);if(!n)if(n=new wr(yr,this),this._builtins.has(e))n.define(e,hr(this._builtins.get(e)));else if(this._runtime._builtin._scope.has(e))n.import(e,this._runtime._builtin);else{try{t=this._runtime._global(e)}catch(t){return n.define(e,function(e){return()=>{throw e}}(t))}void 0===t?this._scope.set(n._name=e,n):n.define(e,hr(t))}return n},writable:!0,configurable:!0},redefine:{value:function(e){const t=this._scope.get(e);if(!t)throw new dr(`${e} is not defined`);if(t._type===br)throw new dr(`${e} is defined more than once`);return t.define.apply(t,arguments)},writable:!0,configurable:!0},define:{value:function(){const e=new wr(vr,this);return e.define.apply(e,arguments)},writable:!0,configurable:!0},derive:{value:function(e,t){const n=new Map,r=new Set,i=[];function s(e){let t=n.get(e);return t||(t=new Nr(e._runtime,e._builtins),t._source=e,n.set(e,t),i.push([t,e]),r.add(e),t)}const o=s(this);for(const n of e){const{alias:e,name:r}="object"==typeof n?n:{name:n};o.import(r,e??r,t)}for(const e of r)for(const[t,n]of e._scope)if(n._definition===fr){if(e===this&&o._scope.has(t))continue;const r=n._inputs[0]._module;r._source&&s(r)}for(const[e,t]of i)for(const[r,i]of t._scope){const t=e._scope.get(r);if(!t||t._type===yr)if(i._definition===fr){const t=i._inputs[0],s=t._module;e.import(t._name,r,n.get(s)||s)}else e.define(r,i._inputs.map(jr),i._definition)}return o},writable:!0,configurable:!0},import:{value:function(){const e=new wr(vr,this);return e.import.apply(e,arguments)},writable:!0,configurable:!0},value:{value:async function(e){let t=this._scope.get(e);if(!t)throw new dr(`${e} is not defined`);if(t._observer!==_r)return Rr(this._runtime,t);t=this.variable(!0).define([e],fr);try{return await Rr(this._runtime,t)}finally{t.delete()}},writable:!0,configurable:!0},variable:{value:function(e){return new wr(vr,this,e)},writable:!0,configurable:!0},builtin:{value:function(e,t){this._builtins.set(e,t)},writable:!0,configurable:!0}});const Or="function"==typeof requestAnimationFrame?requestAnimationFrame:"function"==typeof setImmediate?setImmediate:e=>setTimeout(e,0);function Mr(e=new cr,t=Fr){const n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:t}}),e)for(const t in e)new wr(yr,n).define(t,[],e[t])}function Ir(e){const t=new Set(e._inputs);for(const n of t){if(n===e)return!0;n._inputs.forEach(t.add,t)}return!1}function Pr(e){++e._indegree}function Lr(e){--e._indegree}function Dr(e){return e._promise.catch(e._rejector)}function qr(e){return new Promise((function(t){e._invalidate=t}))}function Ur(e,t){let n,r,i="function"==typeof IntersectionObserver&&t._observer&&t._observer._node,s=!i,o=mr,a=mr;return i&&(r=new IntersectionObserver((([e])=>(s=e.isIntersecting)&&(n=null,o()))),r.observe(i),e.then((()=>(r.disconnect(),r=null,a())))),function(e){return s?Promise.resolve(e):r?(n||(n=new Promise(((e,t)=>(o=e,a=t)))),n.then((()=>e))):Promise.reject()}}function Br(e){e._invalidate(),e._invalidate=mr,e._pending();const t=e._value,n=++e._version;let r=null;const i=e._promise=(e._inputs.length?Promise.all(e._inputs.map(Dr)).then((function(i){if(e._version!==n)throw $r;for(let t=0,n=i.length;t<n;++t)switch(i[t]){case Tr:i[t]=r=qr(e);break;case Cr:r||(r=qr(e)),i[t]=Ur(r,e);break;case xr:i[t]=e}return e._definition.apply(t,i)})):new Promise((n=>n(e._definition.call(t))))).then((function(t){if(e._version!==n)throw $r;if(function(e){return e&&"function"==typeof e.next&&"function"==typeof e.return}(t))return(r||qr(e)).then((i=t,function(){i.return()})),function(e,t,n){const r=e._module._runtime;let i;function s(e){return new Promise((e=>e(n.next(i)))).then((({done:t,value:n})=>t?void 0:Promise.resolve(n).then(e)))}function o(){const n=s((s=>{if(e._version!==t)throw $r;return i=s,a(s,n).then((()=>r._precompute(o))),e._fulfilled(s),s}));n.catch((r=>{r!==$r&&e._version===t&&(a(void 0,n),e._rejected(r))}))}function a(t,n){return e._value=t,e._promise=n,e._outputs.forEach(r._updates.add,r._updates),r._compute()}return s((n=>{if(e._version!==t)throw $r;return i=n,r._precompute(o),n}))}(e,n,t);var i;return t}));i.then((t=>{e._value=t,e._fulfilled(t)}),(t=>{t!==$r&&(e._value=void 0,e._rejected(t))}))}function Hr(e,t){e._invalidate(),e._invalidate=mr,e._pending(),++e._version,e._indegree=NaN,(e._promise=Promise.reject(t)).catch(mr),e._value=void 0,e._rejected(t)}function Fr(e){return globalThis[e]}Object.defineProperties(Mr.prototype,{_precompute:{value:function(e){this._precomputes.push(e),this._compute()},writable:!0,configurable:!0},_compute:{value:function(){return this._computing||(this._computing=this._computeSoon())},writable:!0,configurable:!0},_computeSoon:{value:function(){return new Promise(Or).then((()=>this._disposed?void 0:this._computeNow()))},writable:!0,configurable:!0},_computeNow:{value:async function(){let e,t,n=[],r=this._precomputes;if(r.length){this._precomputes=[];for(const e of r)e();await function(e=0){let t=Promise.resolve();for(let n=0;n<e;++n)t=t.then((()=>{}));return t}(3)}e=new Set(this._dirty),e.forEach((function(t){t._inputs.forEach(e.add,e);const n=function(e){if(e._observer!==_r)return!0;const t=new Set(e._outputs);for(const e of t){if(e._observer!==_r)return!0;e._outputs.forEach(t.add,t)}return!1}(t);n>t._reachable?this._updates.add(t):n<t._reachable&&t._invalidate(),t._reachable=n}),this),e=new Set(this._updates),e.forEach((function(t){t._reachable?(t._indegree=0,t._outputs.forEach(e.add,e)):(t._indegree=NaN,e.delete(t))})),this._computing=null,this._updates.clear(),this._dirty.clear(),e.forEach((function(e){e._outputs.forEach(Pr)}));do{for(e.forEach((function(e){0===e._indegree&&n.push(e)}));t=n.pop();)Br(t),t._outputs.forEach(i),e.delete(t);e.forEach((function(t){Ir(t)&&(Hr(t,new dr("circular definition")),t._outputs.forEach(Lr),e.delete(t))}))}while(e.size);function i(e){0==--e._indegree&&n.push(e)}},writable:!0,configurable:!0},dispose:{value:function(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach((e=>{e._invalidate(),e._version=NaN}))},writable:!0,configurable:!0},module:{value:function(e,t=mr){let n;if(void 0===e)return(n=this._init)?(this._init=null,n):new Nr(this);if(n=this._modules.get(e),n)return n;this._init=n=new Nr(this),this._modules.set(e,n);try{e(this,t)}finally{this._init=null}return n},writable:!0,configurable:!0},fileAttachments:{value:function(e){return Object.assign((t=>{const n=e(t+="");if(null==n)throw new Error(`File not found: ${t}`);if("object"==typeof n&&"url"in n){const{url:e,mimeType:r}=n;return new Pn(e,t,r)}return new Pn(n,t)}),{prototype:Pn.prototype})},writable:!0,configurable:!0}});const Wr=Mr.prototype.fileAttachments((function(e){return e}));class zr{constructor(){const e=Object.assign(new cr,{FileAttachment:()=>Wr});this.runtime=new Mr(e),this.main=this.runtime.module()}redefine(e,t,n=[]){this.main.redefine(e,n,t)}variable(e,t,n=[],r){this.main.variable(r).define(e,n,t)}module(e,t){const n=this.runtime.module(e);return t?n.derive(t,this.main):n}import(e,t,n=t){this.main.import(t,n,e)}value(e){return this.main.value(e)}define(e,t){const n=new Map;e.forEach((e=>{if(e.module){const[t,r,i]=e.module;n.set(t,this.module(r,i))}else if(e.import){const[t,r,i]=e.import;this.import(n.get(t),r,i)}else if(e.define){const[n,r,i]=e.define;this.variable(n,i,r,t(e))}}))}handler(e){return async t=>{t.preventDefault();const[n,r]=await this.value(e),i=await Promise.all(r.map((e=>this.value(e)))),s=Object.create(null);i.forEach(((e,t)=>s[r[t]]=e)),await n(s)(t),i.forEach(((e,t)=>{const n=r[t];e!==s[n]&&this.redefine(n,s[n])}))}}}class Vr extends ne{createRenderRoot(){return this}connectedCallback(){this.__initchildnodes||(this.__initchildnodes=!0,this.initialChildNodes(Array.from(this.childNodes,(e=>(e.__element=this,e)))),function(e,t=0){const n=e.childNodes;let r=n.length;for(;r>t;)e.removeChild(n[--r])}(this)),super.connectedCallback()}initialChildNodes(e){this.__children=e}articleData(){let e=this;for(;"ARTICLE"!==e.tagName;e=e.parentNode||e.__element);return e?.__data}}function Gr(e){return L`<span class="error-block">${e}</span>`}class Jr extends Vr{constructor(){super(),this.visible=!1,this.addEventListener("keydown",this.keyDown),this.addEventListener("mousedown",this.mouseDown)}mouseDownClose=e=>{this.contains(e.target)||this.hide()};keyDownClose=e=>{Zr(e.key)&&this.hide()};keyDown(e){Yr(e.key)&&!this.visible&&this.show()}mouseDown(){this.visible||this.show()}hide(){this.querySelector(".tooltip").style.display="none",this.visible=!1,document.removeEventListener("keydown",this.keyDownClose),document.removeEventListener("mousedown",this.mouseDownClose)}show(){const e=this.querySelector(".tooltip");e.style.display="inline-block",this.visible=!0,function(e,t){t.style.transform="translate(0, 0)";const n=t.getBoundingClientRect(),r=document.body.clientWidth-16,i=n.width>r?-n.left:n.right>r?r-n.right:0;t.style.transform=`translate(${i}px, ${e+4}px)`}(this.getBoundingClientRect().height,e),document.addEventListener("keydown",this.keyDownClose),document.addEventListener("mousedown",this.mouseDownClose)}renderWithTooltip(e,t,n){const r=L`<div class="tooltip">${n}</div>`;return L`<span class=${e} tabindex=0>${r}${t}</span>`}}const Yr=(e,t="Enter")=>e===t,Zr=(e,t="Escape")=>e===t;function Kr(){this.querySelector(".cite-author-expand").style.display="none",this.querySelector(".cite-author-hidden").style.display="inline"}function Xr(){this.querySelector(".cite-author-expand").style.display="inline",this.querySelector(".cite-author-hidden").style.display="none"}const Qr="dependencies",ei=Symbol("dependencies"),ti=Symbol("load"),ni=Promise.resolve(!0),ri=new Map;function ii(e){let t="undefined"!=typeof HTMLElement&&e instanceof HTMLElement?e.constructor:e;for(;t&&!Object.hasOwn(t,Qr);)if(t=Object.getPrototypeOf(t),t&&"HTMLElement"===t.name)return null;return t}function si(e){const t=ii(e);if(!t)return ni;const n=t[ei]||(t[ei]={});if(n[ti])return n[ti];const r={main:[],css:[]},i=t[Qr];return i.forEach((({name:t,version:n,main:i,css:s})=>{const o=function(e,t){return n=>`https://cdn.jsdelivr.net/npm/${e}@${t}/${n}`}(t,n),a=o(i),l=o(s),c=ri.get(a)||mt(a);ri.set(a,c),r.main.push(c),s&&!ri.has(l)&&(ri.set(l,!0),r.css.push(function(e,t=globalThis.document){return new Promise((function(n,r){const i=t.createElement("link");i.rel="stylesheet",i.href=e,i.onerror=r,i.onload=n,t.head.appendChild(i)}))}(l,e.ownerDocument)))})),n[ti]=Promise.all(r.main.concat(r.css)).then((e=>{const n=i.reduce(((t,n,r)=>(t[n.name]=e[r],t)),{});!function(e,t){const n=ii(e);if(n){const e=n[ei]||(n[ei]={});for(const n in t)e[n]=t[n];e[ti]=ni}}(t,n)}))}class oi extends Vr{getDependency(e){return function(e,t){return ii(e)?.[ei]?.[t]}(this,e)}shouldUpdate(){return!!function(e){const t=ii(e);return!t||t[ei]?.[ti]===ni}(this)||(si(this).then((()=>{this.requestUpdate()})),!1)}}const ai="tag";function li(e,t){if(t.className===ai)return;const n=t.cloneNode();if(n.id&&n.removeAttribute("id"),e.append(n),!di(t))for(const e of t.childNodes)li(n,e)}const ci={SECTION:"sec",FIGURE:"fig",TABLE:"tbl",EQUATION:"eqn"},ui=new Set(["CITE-REF","CODE-BLOCK","CROSS-REF","INLINE-NOTE","RANGE-TEXT","TEX-MATH"]),di=e=>ui.has(e.tagName);let hi=0;class fi extends oi{static get dependencies(){return[{name:"katex",version:"0.15.3",module:"dist/katex.mjs",main:"dist/katex.min.js",css:"dist/katex.min.css"}]}static get properties(){return{mode:{type:String},code:{type:String},leqno:{type:Boolean},fleqn:{type:Boolean,converter:e=>"false"!==e},minRuleThickness:{type:Number}}}constructor(){super(),this.mode="display",this.leqno=!1,this.fleqn=!1}initialChildNodes(e){!this.hasAttribute("code")&&e.length&&(this.code=e[0].textContent)}prepareMath(){return this.code}render(){const e=this.getDependency("katex");if(!e||!this.code)return;const t="display"===this.mode,n={throwOnError:!1,displayMode:t,leqno:this.leqno,fleqn:this.fleqn,minRuleThickness:this.minRuleThickness},r=document.createElement(t?"div":"span");return e.render(this.prepareMath(),r,n),r}}var pi=Object.freeze({__proto__:null,attrs:function(){return[{define:[null,["max"],function(e){return-e}],cell:0},{define:[null,["max"],function(e){return e}],cell:1},{define:[null,["step"],function(e){return e}],cell:2},{define:[null,["format","sinc","value"],function(e,t,n){return`sinc(x) = ${e(t(n))}`}],cell:3}]},cells:function(){return[{module:[1,e]},{import:[1,"Scrubber"]},{define:["viewof rot",["Scrubber"],function(e){return e([0,10],{step:.05,value:5,alternate:!0,label:"Rotation",format:e=>e.toFixed(2)})}],cell:1},{define:["rot",["Generators","viewof rot"],(e,t)=>e.input(t)]},{define:["viewof sep",["Scrubber"],function(e){return e([1,100],{value:4,alternate:!0,label:"Separation"})}],cell:2},{define:["sep",["Generators","viewof sep"],(e,t)=>e.input(t)]},{define:["size",[],function(){return 25}],cell:3},{define:["n",["size","sep"],function(e,t){return Math.ceil((800+4*e)/t)}],cell:4},{define:["pad",[],function(){return 30}],cell:5},{define:["color",["d3"],function(e){return e.scaleSequential(e.interpolateRainbow).domain([360,0])}],cell:6},{define:[null,["svg","size","pad","d3","n","rot","sep","color"],function(e,t,n,r,i,s,o,a){return e`<svg width="${800}" height="${2*t+n}" viewBox="0 0 800 ${2*t+n}">
  ${r.range(0,i).map((r=>{const i=r*s%360;return e`<rect
      transform="translate(${r*o-2*t-1}, ${n/2}) rotate(${-i}, ${t}, ${t})"
      width="${2*t}" height="${2*t}"
      fill="none" stroke="${a(i)}"></rect>`}))}
  </svg>`}],cell:7},{define:["value",[],function(){return-10}],cell:8},{define:["max",[],function(){return 10}],cell:9},{define:["step",[],function(){return.1}],cell:10},{define:["sinc",[],function(){return e=>0===e?1:Math.sin(Math.PI*e)/(Math.PI*e)}],cell:11},{define:["format",[],function(){return e=>e.toFixed(2).replace("-0.00","0.00")}],cell:12},{define:[null,["Plot","value","d3","max","step","sinc"],function(e,t,n,r,i,s){return e.plot({y:{grid:!0},marks:[e.ruleX([t],{stroke:"#888"}),e.line(n.range(-r,Math.max(r+i,t),i),{x:e=>e,y:e=>s(e),stroke:"steelblue",strokeWidth:2}),e.dot([t],{x:e=>e,y:e=>s(e),fill:"steelblue"})],width:400,height:250})}],cell:13},{define:[null,["Scrubber","max","step","tex"],function(e,t,n,r){return e([-t,t],{step:n,labelWidth:"20px",loop:!1,label:r`x`,format:e=>e.toFixed(1)})}],cell:14},{define:["chartWidth",[],function(){return 775}],cell:15},{module:[2,t,[{name:"chartWidth",alias:"width"}]]},{import:[2,"chart","d3LineChart"]},{define:[null,["d3LineChart"],function(e){return e}],cell:17}]}});document.querySelector("article").__data={citations:{bibtex:["@inproceedings{doi:10.1145/3242587.3242600,\n\tauthor = {Conlen, Matthew and Heer, Jeffrey},\n\tbooktitle = {Proceedings of the 31st {Annual} {ACM} {Symposium} on {User} {Interface} {Software} and {Technology}},\n\tyear = {2018},\n\tmonth = {oct 11},\n\torganization = {ACM},\n\ttitle = {Idyll},\n}","@inproceedings{conlen2021,\n\tauthor = {Conlen, Matthew and Vo, Megan and Tan, Alan and Heer, Jeffrey},\n\tbooktitle = {The 34th {Annual} {ACM} {Symposium} on {User} {Interface} {Software} and {Technology}},\n\tyear = {2021},\n\tpages = {1--12},\n\ttitle = {Idyll {Studio}: A structured editor for authoring interactive & data-driven articles},\n}"],csl:[{indexed:{"date-parts":[[2023,3,23]],"date-time":"2023-03-23T23:51:34Z",timestamp:1679615494987},"publisher-location":"New York, NY, USA","reference-count":46,publisher:"ACM",license:[{start:{"date-parts":[[2018,10,11]],"date-time":"2018-10-11T00:00:00Z",timestamp:1539216e6},"content-version":"vor","delay-in-days":0,URL:"http://www.acm.org/publications/policies/copyright_policy#Background"}],"content-domain":{domain:["dl.acm.org"],"crossmark-restriction":!0},"published-print":{"date-parts":[[2018,10,11]]},DOI:"10.1145/3242587.3242600",type:"proceedings-article",created:{"date-parts":[[2018,10,16]],"date-time":"2018-10-16T13:30:26Z",timestamp:1539696626e3},"update-policy":"http://dx.doi.org/10.1145/crossmark-policy",source:"Crossref","is-referenced-by-count":30,title:"Idyll",prefix:"10.1145",author:[{given:"Matthew",family:"Conlen",sequence:"first",affiliation:[{name:"University of Washington, Seattle, WA, USA"}]},{given:"Jeffrey",family:"Heer",sequence:"additional",affiliation:[{name:"University of Washington, Seattle, WA, USA"}]}],member:"320","published-online":{"date-parts":[[2018,10,11]]},reference:[{key:"e_1_3_2_2_1_1","volume-title":"Retrieved",year:"2008",unstructured:"2008. Jekyll. ( 2008 ). Retrieved August 1, 2017 from https://jekyllrb.com/ 2008. Jekyll. (2008). Retrieved August 1, 2017 from https://jekyllrb.com/"},{key:"e_1_3_2_2_2_1","volume-title":"Retrieved",year:"2013",unstructured:"2013. Fangle. ( 2013 ). Retrieved September 19, 2017 from https://github.com/jotux/fangle 2013. Fangle. (2013). Retrieved September 19, 2017 from https://github.com/jotux/fangle"},{key:"e_1_3_2_2_3_1","volume-title":"Retrieved",year:"2015",unstructured:"2015. React. ( 2015 ). Retrieved August 1, 2017 from https://facebook.github.io/react/ 2015. React. (2015). Retrieved August 1, 2017 from https://facebook.github.io/react/"},{key:"e_1_3_2_2_4_1","volume-title":"Explorable Explanations Web Catalog. (2017). Retrieved",year:"2017",unstructured:"2017. Explorable Explanations Web Catalog. (2017). Retrieved August 1, 2017 from http://explorabl.es/ 2017. Explorable Explanations Web Catalog. (2017). Retrieved August 1, 2017 from http://explorabl.es/"},{key:"e_1_3_2_2_5_1","volume-title":"Idyll download count. (2017). Retrieved",year:"2017",unstructured:"2017. Idyll download count. (2017). Retrieved August 1, 2017 from https://npm-stat.com/charts.html?package=idyll 2017. Idyll download count. (2017). Retrieved August 1, 2017 from https://npm-stat.com/charts.html?package=idyll"},{key:"e_1_3_2_2_6_1","doi-asserted-by":"publisher",DOI:"10.1145/3025453.3025631"},{key:"e_1_3_2_2_7_1",unstructured:"Bill Atkinson. 1988. Hypercard. Apple Computer.  Bill Atkinson. 1988. Hypercard. Apple Computer."},{key:"e_1_3_2_2_8_1","doi-asserted-by":"publisher",DOI:"10.1145/2501654.2501666"},{key:"e_1_3_2_2_9_1","volume-title":"Retrieved",author:"Bollweg Nicholas",year:"2011",unstructured:"Nicholas Bollweg . 2011 . TangleDown. (2011) . Retrieved September 19, 2017 from https://github.com/bollwyvl/TangleDown Nicholas Bollweg. 2011. TangleDown. (2011). Retrieved September 19, 2017 from https://github.com/bollwyvl/TangleDown"},{key:"e_1_3_2_2_10_1","volume-title":"D3: Data-Driven Documents",author:"Bostock Michael",year:"2011",unstructured:"Michael Bostock , Vadim Ogievetsky , and Jeffrey Heer . 2011. D3: Data-Driven Documents . IEEE Trans. Visualization & Comp. Graphics (Proc. InfoVis) ( 2011 ). http://vis.stanford.edu/papers/d3 Michael Bostock, Vadim Ogievetsky, and Jeffrey Heer. 2011. D3: Data-Driven Documents. IEEE Trans. Visualization & Comp. Graphics (Proc. InfoVis) (2011). http://vis.stanford.edu/papers/d3"},{key:"e_1_3_2_2_11_1","doi-asserted-by":"publisher",DOI:"10.1109/TVCG.2016.2614803"},{key:"e_1_3_2_2_12_1",unstructured:"Bill Burdick. 2011. leisure. https://github.com/zot/Leisure. (2011).  Bill Burdick. 2011. leisure. https://github.com/zot/Leisure. (2011)."},{key:"e_1_3_2_2_13_1","doi-asserted-by":"publisher",DOI:"10.1016/j.jvlc.2016.07.004"},{key:"e_1_3_2_2_14_1","volume-title":"Retrieved",year:"2017",unstructured:"Distill. 2017 . Latest articles about machine learning. (2017) . Retrieved September 19, 2017 from https://distill.pub/ Distill. 2017. Latest articles about machine learning. (2017). Retrieved September 19, 2017 from https://distill.pub/"},{key:"e_1_3_2_2_15_1","doi-asserted-by":"publisher",DOI:"10.1145/258948.258973"},{key:"e_1_3_2_2_16_1","volume-title":"Retrieved",author:"Gruber John",year:"2004",unstructured:"John Gruber . 2004. Markdown. ( 2004 ). Retrieved August 1, 2017 from https://daringfireball.net/projects/markdown/syntax/ John Gruber. 2004. Markdown. (2004). Retrieved August 1, 2017 from https://daringfireball.net/projects/markdown/syntax/"},{key:"e_1_3_2_2_17_1","volume-title":"Retrieved",author:"Kapoor Amit",year:"2016",unstructured:"Amit Kapoor . 2016. Visdown. ( 2016 ). Retrieved August 1, 2017 from http://visdown.amitkaps.com/ Amit Kapoor. 2016. Visdown. (2016). Retrieved August 1, 2017 from http://visdown.amitkaps.com/"},{key:"e_1_3_2_2_18_1","doi-asserted-by":"publisher",DOI:"10.1145/2702123.2702140"},{key:"e_1_3_2_2_19_1","doi-asserted-by":"publisher",DOI:"10.1109/MC.2013.36"},{key:"e_1_3_2_2_20_1",unstructured:"Maarten Lambrechts. 2016. Rock 'n Poll: Polls explained with interactive graphics. https://web.archive.org/web/20180307013513/http://rocknpoll.graphics/. (2016).  Maarten Lambrechts. 2016. Rock 'n Poll: Polls explained with interactive graphics. https://web.archive.org/web/20180307013513/http://rocknpoll.graphics/. (2016)."},{key:"e_1_3_2_2_21_1","volume-title":"Petra Isenberg, and Sheelagh Carpendale.",author:"Lee Bongshin",year:"2015",unstructured:"Bongshin Lee , Nathalie Henry Riche , Petra Isenberg, and Sheelagh Carpendale. 2015 . More than telling a story: Transforming data into visually shared stories. IEEE computer graphics and applications 35, 5 (2015), 84--90. Bongshin Lee, Nathalie Henry Riche, Petra Isenberg, and Sheelagh Carpendale. 2015. More than telling a story: Transforming data into visually shared stories. IEEE computer graphics and applications 35, 5 (2015), 84--90."},{key:"e_1_3_2_2_22_1","volume-title":"Cascading style sheets: designing for the Web",author:"Lie Hakon Wium",unstructured:"Hakon Wium Lie and Bert Bos . 2005. Cascading style sheets: designing for the Web . Addison-Wesley Professional . Hakon Wium Lie and Bert Bos. 2005. Cascading style sheets: designing for the Web. Addison-Wesley Professional."},{key:"e_1_3_2_2_23_1","doi-asserted-by":"publisher",DOI:"10.1109/MCG.2012.24"},{key:"e_1_3_2_2_24_1","doi-asserted-by":"publisher",DOI:"10.1111/cgf.13195"},{key:"e_1_3_2_2_25_1","doi-asserted-by":"publisher",DOI:"10.1145/1639949.1640091"},{key:"e_1_3_2_2_26_1","doi-asserted-by":"publisher",DOI:"10.1145/344949.344959"},{key:"e_1_3_2_2_27_1",unstructured:"Observable 2018. Observable. https://observablehq.com/. (2018).  Observable 2018. Observable. https://observablehq.com/. (2018)."},{key:"e_1_3_2_2_28_1","volume-title":"Research Debt. Distill",author:"Olah Chris",year:"2017",unstructured:"Chris Olah and Shan Carter . 2017. Research Debt. Distill ( 2017 ). Retrieved August 1, 2017 from http://distill.pub/2017/research-debt Chris Olah and Shan Carter. 2017. Research Debt. Distill (2017). Retrieved August 1, 2017 from http://distill.pub/2017/research-debt"},{key:"e_1_3_2_2_29_1","doi-asserted-by":"publisher",DOI:"10.1109/MCSE.2007.53"},{key:"e_1_3_2_2_30_1",unstructured:"Polymer Project 2017. Polymer Project. https://www.polymer-project.org/. (2017).  Polymer Project 2017. Polymer Project. https://www.polymer-project.org/. (2017)."},{key:"e_1_3_2_2_31_1",unstructured:"National Public Radio. 2016. dailygraphics. https://github.com/nprapps/dailygraphics. (2016).  National Public Radio. 2016. dailygraphics. https://github.com/nprapps/dailygraphics. (2016)."},{key:"e_1_3_2_2_32_1","doi-asserted-by":"publisher",DOI:"10.1145/3126594.3126642"},{key:"e_1_3_2_2_33_1","first-page":"3","article-title":"Authoring Narrative Visualizations with",volume:"33",author:"Satyanarayan Arvind",year:"2014",unstructured:"Arvind Satyanarayan and Jeffrey Heer . 2014 . Authoring Narrative Visualizations with Ellipsis. Comput. Graph. Forum 33 , 3 (June 2014), 361--370. Arvind Satyanarayan and Jeffrey Heer. 2014. Authoring Narrative Visualizations with Ellipsis. Comput. Graph. Forum 33, 3 (June 2014), 361--370.","journal-title":"Ellipsis. Comput. Graph. Forum"},{key:"e_1_3_2_2_34_1","doi-asserted-by":"publisher",DOI:"10.1109/TVCG.2016.2599030"},{key:"e_1_3_2_2_35_1","doi-asserted-by":"publisher",DOI:"10.1145/2642918.2647360"},{key:"e_1_3_2_2_36_1",unstructured:"Toby Schachman and Joshua Horowitz. 2016. Apparatus. https://github.com/cdglabs. (2016).  Toby Schachman and Joshua Horowitz. 2016. Apparatus. https://github.com/cdglabs. (2016)."},{key:"e_1_3_2_2_37_1","doi-asserted-by":"publisher",DOI:"10.1109/TVCG.2010.179"},{key:"e_1_3_2_2_38_1","volume-title":"Emerging and recurring data-driven storytelling techniques: Analysis of a curated collection of recent stories",author:"Stolper Charles D",year:"2016",unstructured:"Charles D Stolper , Bongshin Lee , N Henry Riche , and John Stasko . 2016. Emerging and recurring data-driven storytelling techniques: Analysis of a curated collection of recent stories . Microsoft Research , Washington, USA ( 2016 ). Charles D Stolper, Bongshin Lee, N Henry Riche, and John Stasko. 2016. Emerging and recurring data-driven storytelling techniques: Analysis of a curated collection of recent stories. Microsoft Research, Washington, USA (2016)."},{key:"e_1_3_2_2_39_1","volume-title":"Archie Markup Language (ArchieML). (2015). Retrieved",author:"Strickland Michael",year:"2017",unstructured:"Michael Strickland , Archie Tse , Matthew Ericson , and Tom Giratikanon . 2015. Archie Markup Language (ArchieML). (2015). Retrieved August 1, 2017 from http://archieml.org/ Michael Strickland, Archie Tse, Matthew Ericson, and Tom Giratikanon. 2015. Archie Markup Language (ArchieML). (2015). Retrieved August 1, 2017 from http://archieml.org/"},{key:"e_1_3_2_2_40_1",unstructured:"Tampa Bay Times. 2016. lede. https://github.com/tbtimes/lede. (2016).  Tampa Bay Times. 2016. lede. https://github.com/tbtimes/lede. (2016)."},{key:"e_1_3_2_2_41_1",unstructured:"The New York Times. 2017. kyt. https://github.com/NYTimes/kyt. (2017).  The New York Times. 2017. kyt. https://github.com/NYTimes/kyt. (2017)."},{key:"e_1_3_2_2_42_1","doi-asserted-by":"publisher",DOI:"10.1145/2984511.2984551"},{key:"e_1_3_2_2_43_1","volume-title":"Magic Ink: Information Software and the Graphical Interface. Retrieved",author:"Victor Bret",year:"2006",unstructured:"Bret Victor . 2006 . Magic Ink: Information Software and the Graphical Interface. Retrieved August 1, 2017 from http://worrydream.com/MagicInk/ Bret Victor. 2006. Magic Ink: Information Software and the Graphical Interface. Retrieved August 1, 2017 from http://worrydream.com/MagicInk/"},{key:"e_1_3_2_2_44_1",unstructured:"Bret Victor. 2011a. Explorable Explorations. Retrieved August 1 2017 from http://worrydream.com/ExplorableExplanations/  Bret Victor. 2011a. Explorable Explorations. Retrieved August 1 2017 from http://worrydream.com/ExplorableExplanations/"},{key:"e_1_3_2_2_45_1",unstructured:"Bret Victor. 2011b. Scientific Communication As Sequential Art. http://worrydream.com/ScientificCommunicationAsSequentialArt/.  Bret Victor. 2011b. Scientific Communication As Sequential Art. http://worrydream.com/ScientificCommunicationAsSequentialArt/."},{key:"e_1_3_2_2_46_1","volume-title":"Tangle: a JavaScript library for reactive documents. Retrieved",author:"Victor Bret",year:"2017",unstructured:"Bret Victor . 2011c. Tangle: a JavaScript library for reactive documents. Retrieved August 1, 2017 from http://worrydream.com/Tangle/ Bret Victor. 2011c. Tangle: a JavaScript library for reactive documents. Retrieved August 1, 2017 from http://worrydream.com/Tangle/"}],event:"UIST '18: The 31st Annual ACM Symposium on User Interface Software and Technology","container-title":"Proceedings of the 31st Annual ACM Symposium on User Interface Software and Technology","original-title":[],link:[{URL:"https://dl.acm.org/doi/pdf/10.1145/3242587.3242600","content-type":"unspecified","content-version":"vor","intended-application":"similarity-checking"}],deposited:{"date-parts":[[2023,1,6]],"date-time":"2023-01-06T16:09:14Z",timestamp:1673021354e3},score:1,resource:{primary:{URL:"https://dl.acm.org/doi/10.1145/3242587.3242600"}},subtitle:["A Markup Language for Authoring and Publishing Interactive Articles on the Web"],"short-title":[],issued:{"date-parts":[[2018,10,11]]},"references-count":46,"alternative-id":["10.1145/3242587.3242600","10.1145/3242587"],URL:"http://dx.doi.org/10.1145/3242587.3242600",relation:{},published:{"date-parts":[[2018,10,11]]},assertion:[{value:"2018-10-11",order:2,name:"published",label:"Published",group:{name:"publication_history",label:"Publication History"}}],id:"doi:10.1145/3242587.3242600",S2ID:"4fca64e6dc4e803d3ed904c04c6845a9e6adc53e"},{author:[{given:"Matthew",family:"Conlen"},{given:"Megan",family:"Vo"},{given:"Alan",family:"Tan"},{given:"Jeffrey",family:"Heer"}],"container-title":"The 34th Annual ACM Symposium on User Interface Software and Technology",type:"paper-conference",id:"conlen2021","citation-key":"conlen2021",issued:{"date-parts":[[2021]]},page:"1-12",title:"Idyll Studio: A structured editor for authoring interactive & data-driven articles"}],data:[{id:"doi:10.1145/3242587.3242600",doi:"10.1145/3242587.3242600",s2id:"4fca64e6dc4e803d3ed904c04c6845a9e6adc53e",year:2018,author:[{given:"Matthew",family:"Conlen",sequence:"first",affiliation:[{name:"University of Washington, Seattle, WA, USA"}]},{given:"Jeffrey",family:"Heer",sequence:"additional",affiliation:[{name:"University of Washington, Seattle, WA, USA"}]}],title:"Idyll: A Markup Language for Authoring and Publishing Interactive Articles on the Web",venue:"Proceedings of the 31st Annual ACM Symposium on User Interface Software and Technology",url:"https://www.semanticscholar.org/paper/4fca64e6dc4e803d3ed904c04c6845a9e6adc53e",abstract:'The web has matured as a publishing platform: news outlets regularly publish rich, interactive stories while technical writers use animation and interaction to communicate complex ideas. This style of interactive media has the potential to engage a large audience and more clearly explain concepts, but is expensive and time consuming to produce. Drawing on industry experience and interviews with domain experts, we contribute design tools to make it easier to author and publish interactive articles. We introduce Idyll, a novel "compile-to-the-web" language for web-based interactive narratives. Idyll implements a flexible article model, allowing authors control over document style and layout, reader-driven events (such as button clicks and scroll triggers), and a structured interface to JavaScript components. Through both examples and first-use results from undergraduate computer science students, we show how Idyll reduces the amount of effort and custom code required to create interactive articles.',tldr:'This work introduces Idyll, a novel "compile-to-the-web" language for web-based interactive narratives, and shows how Idyll reduces the amount of effort and custom code required to create interactive articles.'},{id:"conlen2021",year:2021,author:[{given:"Matthew",family:"Conlen"},{given:"Megan",family:"Vo"},{given:"Alan",family:"Tan"},{given:"Jeffrey",family:"Heer"}],title:"Idyll Studio: A structured editor for authoring interactive & data-driven articles",venue:"The 34th Annual ACM Symposium on User Interface Software and Technology"}]}},window.customElements.define("cell-view",class extends Vr{static get properties(){return{value:{state:!0},status:{type:String,state:!0}}}constructor(){super(),this.status=he,this.observer=new me(((e,t)=>{this.status=e,e!==he&&(this.value=t,this.dispatchEvent(new Event("change")))}))}render(){switch(this.status){case he:case fe:return this.value;case pe:return Gr(this.value.error);default:return Gr(`Unrecognized status: ${this.status}.`)}}}),window.customElements.define("cite-ref",class extends Jr{static get properties(){return{key:{type:String},mode:{type:String},index:{type:Number}}}constructor(){super(),this.mode="citation"}initialChildNodes(e){this.__prefix=e[0],this.__suffix=e[1]}citeData(){return this.data||(this.data=this.articleData()?.citations?.data[this.index-1])}render(){const{key:e,index:t,mode:n,data:r=this.citeData()}=this,i="cite-ref"+(r?"":" unresolved"),s=null==r?t??"??":"inline-author"===n?function(e,t,n=2){const{author:r,title:i}=e;if(!r||!r.length)return`${i} [${t}]`;let s=r[0].family;2===r.length?s+=` & ${r[1].family}`:r.length>n&&(s+=" et al.");return`${s} [${t}]`}(r,t):t;return this.renderWithTooltip(i,s,function(e,t){return t?L`<div class="cite-info">
      ${function(e){const{url:t,title:n,year:r}=e,i=r?L`\u2022 <span class="cite-year">${r}</a>`:"";return L`<div class="cite-title">
    <a href=${t} target="_blank" rel="noopener noreferrer">${n}</a>
    ${i}
  </div>`}(t)}
      ${function(e,t=4){const{author:n}=e,r=(n||[]).map((({given:e,family:t})=>e?`${e.includes(".")?e:e[0]+"."} ${t}`:t)),i=r.length-t;if(i>1){const e=r.slice(0,t).join(", "),n=", "+r.slice(t).join(", "),s=L`<span class="cite-author-button" @click=${Kr}>+${i}&nbsp;authors</span>`,o=L`<span class="cite-author-expand"> ${s}</span>`,a=L` <span class="cite-author-button" @click=${Xr}>less</span>`,l=L`<span class="cite-author-hidden">${n}${a}</span>`;return L`<div class="cite-author">${e}${o}${l}</div>`}return r.length?L`<div class="cite-author">${r.join(", ")}</div>`:null}(t)}
      ${function(e){const{venue:t}=e;return t?L`<div class="cite-venue">${t}</div>`:null}(t)}
      ${function(e,t=300){const{abstract:n,tldr:r}=e,i=r||n;if(!i)return null;const s=i!==r&&i.length>t?i.slice(0,i.slice(0,t).lastIndexOf(" "))+"":i;return L`<div class="cite-detail">${s}</div>`}(t)}
    </div>`:L`<div class="cite-info">
      <strong>Unresolved citation</strong><br>"${e}"
    </div>`}(e,r))}}),window.customElements.define("code-block",class extends oi{static get dependencies(){return[{name:"@uwdata/highlightjs",version:"0.0.1",main:"dist/highlight.min.js",css:"dist/styles/github.css"}]}static get properties(){return{code:{type:String},inline:{type:Boolean},language:{type:String}}}constructor(){super(),this.inline=!1,this.language=null}initialChildNodes(e){!this.hasAttribute("code")&&e.length&&(this.code=e[0].textContent.trim())}render(){const e=this.getDependency("@uwdata/highlightjs");if(!e||!this.code)return;const{language:t,inline:n}=this,r=document.createElement(n?"code":"pre");return t?r.innerHTML=e.highlight(this.code,{language:t}).value:r.innerText=this.code,r}}),window.customElements.define("cross-ref",class extends Jr{static get properties(){return{type:{type:String},xref:{type:String},index:{type:Number},short:{type:Boolean}}}show(){this.renderTooltipContent(),super.show()}goto(e){e.preventDefault();const t=`#${this.xref}`;history.replaceState(null,null,t),document.querySelector(t).scrollIntoView({behavior:"smooth",block:"nearest"})}renderTooltipContent(){if(null==this.index)return;const e=this.querySelector(".cross-ref-tooltip");e.replaceChildren(),li(e,document.getElementById(this.xref)),e.firstElementChild.className=this.type===ci.FIGURE?"figure":this.type===ci.TABLE?"table":""}renderUnresolvedReference(e){const t=L`<div class="cross-ref-tooltip">
      Unresolved ${this.type} reference: ${this.xref}
    </div>`;return this.renderWithTooltip(`${e} unresolved`,"?",t)}renderResolvedReference(e){if(this.type===ci.SECTION)return this.removeEventListener("keydown",this.keyDown),this.removeEventListener("mousedown",this.mouseDown),L`<a class=${e} href="#${this.xref}" @click=${this.goto}>${this.index}</a>`;{const t=L`<div class="cross-ref-tooltip"></div>`;return this.renderWithTooltip(e,this.index,t)}}renderWithTooltip(e,t,n){const r=L`<div class="tooltip">${n}</div>`;return L`<span class=${e} @dblclick=${this.goto} tabindex=0>${r}${t}</span>`}render(){const{type:e,index:t,short:n}=this,r=`cross-ref ${e}${n?"":" full"}`;return null!=t?this.renderResolvedReference(r):this.renderUnresolvedReference(r)}}),window.customElements.define("inline-note",class extends Vr{constructor(){super(),this.number=++hi}render(){const e=this.number;return L`<span class="inline-note" @click=${e=>e.target.parentElement.classList.toggle("open")}>
      <sup class="inline-note-number">${e}</sup>
      <span class="note margin" data-number="${e}">${this.__children}</span>
    </span>`}}),window.customElements.define("range-text",class extends Vr{static get properties(){return{value:{type:Number},step:{type:Number},span:{type:Number},min:{type:Number},max:{type:Number},title:{type:String}}}constructor(){super(),this.value=0,this.step=1,this.span=1,this.min=-1e3,this.max=1e3,this.title="Draggable text",this.addEventListener("click",(e=>e.stopPropagation())),this.addEventListener("mousedown",(e=>this.onMouseDown(e)))}onMouseDown(e){e.stopImmediatePropagation();const t=e.x,n=+this.value,r=this.ownerDocument.body.style.cursor;this.ownerDocument.body.style.cursor="ew-resize";const i=this.style.MozUserSelect;this.style.MozUserSelect="none";const s=e=>{e.preventDefault(),e.stopImmediatePropagation();const{step:r,span:i,min:s,max:o}=this,a=r*Math.round((e.x-t)/i),l=Math.max(Math.min(n+a,o),s);this.value!==l&&(this.value=l,this.dispatchEvent(new CustomEvent("input")),this.requestUpdate())},o=e=>{e.preventDefault(),e.stopImmediatePropagation(),this.ownerDocument.body.style.cursor=r,this.style.MozUserSelect=i,window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",o)};window.addEventListener("mousemove",s),window.addEventListener("mouseup",o)}render(){const e=Math.max(0,Math.ceil(-Math.log10(this.step)));return L`<span class="range-text" title=${this.title}>${this.value.toFixed(e)}</span>`}}),window.customElements.define("tex-equation",class extends fi{static get properties(){return{type:{type:String},nonumber:{type:Boolean}}}constructor(){super(),this.mode="display",this.type="align",this.nonumber=!1}prepareMath(){const e=this.type+(this.nonumber?"*":"");return`\\begin{${e}}\n${this.code}\n\\end{${e}}`}}),window.customElements.define("tex-math",fi),window.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("article");ve(new zr,e,pi,{_id:2,attrs:[["1","min",0],["1","max",1],["1","step",2],["2","code",3]],events:[]})}));
